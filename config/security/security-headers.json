{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "name": "DragNDrop Security Headers Configuration",
  "version": "1.0.0",
  "description": "Security headers configuration for Vercel, Cloudflare, and nginx deployments",
  
  "headers": {
    "Content-Security-Policy": {
      "description": "Controls resources the browser is allowed to load",
      "value": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: blob: https:; connect-src 'self' https://generativelanguage.googleapis.com https://api.vercel.com https://api.github.com wss: ws:; frame-src 'self' blob:; worker-src 'self' blob:; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none'; upgrade-insecure-requests",
      "reportOnly": false
    },
    
    "X-Content-Type-Options": {
      "description": "Prevents MIME type sniffing",
      "value": "nosniff"
    },
    
    "X-Frame-Options": {
      "description": "Prevents clickjacking attacks",
      "value": "DENY"
    },
    
    "X-XSS-Protection": {
      "description": "Legacy XSS protection (deprecated but still useful for older browsers)",
      "value": "1; mode=block"
    },
    
    "Referrer-Policy": {
      "description": "Controls referrer information sent with requests",
      "value": "strict-origin-when-cross-origin"
    },
    
    "Permissions-Policy": {
      "description": "Controls browser features and APIs",
      "value": "accelerometer=(), camera=(), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), payment=(), usb=(), interest-cohort=()"
    },
    
    "Strict-Transport-Security": {
      "description": "Enforces HTTPS connections",
      "value": "max-age=31536000; includeSubDomains; preload"
    },
    
    "Cross-Origin-Opener-Policy": {
      "description": "Isolates browsing context",
      "value": "same-origin"
    },
    
    "Cross-Origin-Embedder-Policy": {
      "description": "Controls cross-origin resource embedding",
      "value": "require-corp"
    },
    
    "Cross-Origin-Resource-Policy": {
      "description": "Controls cross-origin resource sharing",
      "value": "same-origin"
    }
  },
  
  "environments": {
    "development": {
      "overrides": {
        "Content-Security-Policy": {
          "value": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* https://cdn.jsdelivr.net https://unpkg.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: blob: https: http://localhost:*; connect-src 'self' http://localhost:* ws://localhost:* https://generativelanguage.googleapis.com; frame-src 'self' blob:; worker-src 'self' blob:; object-src 'none'"
        },
        "Strict-Transport-Security": {
          "enabled": false
        }
      }
    },
    
    "staging": {
      "overrides": {
        "Content-Security-Policy": {
          "reportOnly": true,
          "reportUri": "/api/csp-report"
        }
      }
    },
    
    "production": {
      "overrides": {}
    }
  },
  
  "cspDirectives": {
    "default-src": ["'self'"],
    "script-src": [
      "'self'",
      "'unsafe-inline'",
      "'unsafe-eval'",
      "https://cdn.jsdelivr.net",
      "https://unpkg.com",
      "https://cdnjs.cloudflare.com"
    ],
    "style-src": [
      "'self'",
      "'unsafe-inline'",
      "https://fonts.googleapis.com",
      "https://cdn.jsdelivr.net"
    ],
    "font-src": [
      "'self'",
      "https://fonts.gstatic.com",
      "data:"
    ],
    "img-src": [
      "'self'",
      "data:",
      "blob:",
      "https:"
    ],
    "connect-src": [
      "'self'",
      "https://generativelanguage.googleapis.com",
      "https://api.vercel.com",
      "https://api.github.com",
      "wss:",
      "ws:"
    ],
    "frame-src": [
      "'self'",
      "blob:"
    ],
    "worker-src": [
      "'self'",
      "blob:"
    ],
    "object-src": ["'none'"],
    "base-uri": ["'self'"],
    "form-action": ["'self'"],
    "frame-ancestors": ["'none'"],
    "upgrade-insecure-requests": []
  },
  
  "notes": {
    "unsafe-inline": "Required for Monaco Editor inline styles and some dynamic content",
    "unsafe-eval": "Required for Monaco Editor and some JavaScript evaluation features",
    "blob": "Required for preview functionality and file handling",
    "wss": "Required for real-time collaboration features"
  }
}
