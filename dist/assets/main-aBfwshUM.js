var e,t,n=Object.defineProperty,o=Object.defineProperties,i=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,c=(e,t,o)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,d=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&c(e,n,t[n]);if(a)for(var n of a(t))l.call(t,n)&&c(e,n,t[n]);return e},p=(e,t)=>o(e,i(t)),u=(e,t,n)=>new Promise((o,i)=>{var r=e=>{try{s(n.next(e))}catch(t){i(t)}},a=e=>{try{s(n.throw(e))}catch(t){i(t)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,a);s((n=n.apply(e,t)).next())}),h=(e={"assets/main-aBfwshUM.js"(e,t){!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let n=null,o=null,i=0,r="todas",a=null,s=null,l=null;const c=[{id:"saas-landing",nombre:"Landing Page SaaS",descripcion:"Perfecta para software, apps y servicios en la nube",categoria:"negocios",emoji:"üöÄ",contenido_html:'<nav style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">\n        <h1 style="margin: 0; font-size: 28px; font-weight: bold;">TuProducto</h1>\n        <div style="display: flex; gap: 30px; align-items: center;">\n          <a href="#" style="color: white; text-decoration: none;">Features</a>\n          <a href="#" style="color: white; text-decoration: none;">Precios</a>\n          <a href="#" style="color: white; text-decoration: none;">Contacto</a>\n          <button style="background: white; color: #667eea; padding: 10px 24px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">Comienza gratis</button>\n        </div>\n      </nav>\n\n      <section style="min-height: 600px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 60px 20px;">\n        <h2 style="font-size: 56px; font-weight: bold; margin: 0 0 20px 0; max-width: 900px;">La soluci√≥n perfecta para tu negocio</h2>\n        <p style="font-size: 20px; margin: 0 0 40px 0; max-width: 700px; opacity: 0.95;">Aumenta tu productividad y automatiza tus procesos con nuestra plataforma inteligente</p>\n        <div style="display: flex; gap: 20px; justify-content: center;">\n          <button style="background: white; color: #667eea; padding: 14px 32px; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer;">Prueba gratis por 14 d√≠as</button>\n          <button style="background: transparent; color: white; padding: 14px 32px; border: 2px solid white; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer;">Ver demo</button>\n        </div>\n      </section>\n\n      <section style="padding: 80px 20px; background: #f8fafc;">\n        <div style="max-width: 1200px; margin: 0 auto;">\n          <h3 style="text-align: center; font-size: 40px; font-weight: bold; margin: 0 0 60px 0; color: #1e293b;">Caracter√≠sticas principales</h3>\n          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 40px;">\n            <div style="padding: 30px; background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-align: center;">\n              <div style="font-size: 48px; margin-bottom: 20px;">‚ö°</div>\n              <h4 style="font-size: 20px; font-weight: bold; margin: 0 0 12px 0; color: #1e293b;">Velocidad ultrarr√°pida</h4>\n              <p style="margin: 0; color: #64748b; line-height: 1.6;">Procesa millones de transacciones sin ralentizarse</p>\n            </div>\n            <div style="padding: 30px; background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-align: center;">\n              <div style="font-size: 48px; margin-bottom: 20px;">üîí</div>\n              <h4 style="font-size: 20px; font-weight: bold; margin: 0 0 12px 0; color: #1e293b;">Seguridad m√°xima</h4>\n              <p style="margin: 0; color: #64748b; line-height: 1.6;">Encriptaci√≥n de nivel empresarial para tus datos</p>\n            </div>\n            <div style="padding: 30px; background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-align: center;">\n              <div style="font-size: 48px; margin-bottom: 20px;">üìà</div>\n              <h4 style="font-size: 20px; font-weight: bold; margin: 0 0 12px 0; color: #1e293b;">An√°lisis en tiempo real</h4>\n              <p style="margin: 0; color: #64748b; line-height: 1.6;">Dashboards inteligentes para tomar mejores decisiones</p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <footer style="background: #1e293b; color: white; padding: 40px 20px; text-align: center;">\n        <p style="margin: 0; color: #94a3b8;">&copy; 2025 TuProducto.io. Todos los derechos reservados.</p>\n      </footer>'},{id:"portfolio",nombre:"Portafolio Profesional",descripcion:"Vitrina profesional para mostrar tu trabajo",categoria:"personal",emoji:"üë®‚Äçüíª",contenido_html:'<nav style="background: white; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">\n        <h1 style="margin: 0; font-size: 24px; font-weight: bold; color: #1e293b;">Juan P√©rez</h1>\n        <div style="display: flex; gap: 30px; align-items: center;">\n          <a href="#inicio" style="color: #1e293b; text-decoration: none; font-weight: 500;">Inicio</a>\n          <a href="#proyectos" style="color: #1e293b; text-decoration: none; font-weight: 500;">Proyectos</a>\n          <a href="#contacto" style="color: #1e293b; text-decoration: none; font-weight: 500;">Contacto</a>\n          <a href="#" style="background: #f97316; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; font-weight: bold;">Descargar CV</a>\n        </div>\n      </nav>\n\n      <section style="padding: 100px 40px; background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); color: white; display: flex; align-items: center; justify-content: center;">\n        <div style="text-align: center; max-width: 600px;">\n          <div style="width: 150px; height: 150px; border-radius: 50%; background: white; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; font-size: 80px;">üë®‚Äçüíª</div>\n          <h2 style="font-size: 48px; font-weight: bold; margin: 0 0 16px 0;">Desarrollador Full Stack</h2>\n          <p style="font-size: 20px; margin: 0 0 30px 0; opacity: 0.9;">Especializado en crear soluciones web modernas y eficientes</p>\n          <p style="font-size: 16px; margin: 0; opacity: 0.85;">Python ‚Ä¢ JavaScript ‚Ä¢ React ‚Ä¢ Django ‚Ä¢ PostgreSQL</p>\n        </div>\n      </section>\n\n      <section style="padding: 80px 40px; background: white;">\n        <div style="max-width: 1200px; margin: 0 auto;">\n          <h3 style="font-size: 32px; font-weight: bold; margin: 0 0 60px 0; color: #1e293b;">Proyectos destacados</h3>\n          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px;">\n            <div style="border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">\n              <div style="background: #667eea; height: 200px; display: flex; align-items: center; justify-content: center; font-size: 80px;">üì±</div>\n              <div style="padding: 30px; background: white;">\n                <h4 style="font-size: 20px; font-weight: bold; margin: 0 0 12px 0; color: #1e293b;">App Mobile</h4>\n                <p style="color: #64748b; margin: 0 0 16px 0; line-height: 1.6;">Aplicaci√≥n m√≥vil para gesti√≥n de tareas</p>\n                <a href="#" style="color: #f97316; text-decoration: none; font-weight: bold;">Ver proyecto ‚Üí</a>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <footer style="background: #1e293b; color: white; padding: 40px 20px; text-align: center;">\n        <p style="margin: 0; color: #94a3b8;">&copy; 2025 Juan P√©rez. Todos los derechos reservados.</p>\n      </footer>'},{id:"blog",nombre:"Blog Minimalista",descripcion:"Plataforma para publicar art√≠culos y historias",categoria:"blog",emoji:"üìù",contenido_html:'<header style="background: white; padding: 20px 40px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">\n        <h1 style="margin: 0; font-size: 24px; font-weight: bold; color: #1e293b;">Mi Blog</h1>\n        <div style="display: flex; gap: 16px;">\n          <input type="text" placeholder="Buscar art√≠culos..." style="padding: 10px 16px; border: 1px solid #e2e8f0; border-radius: 6px; width: 300px;">\n          <button style="padding: 10px 20px; background: #1e293b; color: white; border: none; border-radius: 6px; cursor: pointer;">Buscar</button>\n        </div>\n      </header>\n\n      <section style="padding: 60px 40px; background: linear-gradient(135deg, #1e293b 0%, #334155 100%); color: white;">\n        <div style="max-width: 900px; margin: 0 auto;">\n          <h2 style="font-size: 48px; font-weight: bold; margin: 0 0 20px 0;">√öltimo art√≠culo</h2>\n          <div style="background: rgba(255,255,255,0.1); padding: 30px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);">\n            <span style="background: rgba(255,255,255,0.2); padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: bold;">Tecnolog√≠a</span>\n            <h3 style="font-size: 32px; font-weight: bold; margin: 16px 0; color: white;">Introducci√≥n a Web 3.0</h3>\n            <p style="margin: 0 0 16px 0; line-height: 1.6; opacity: 0.9;">Descubre qu√© es Web 3.0, c√≥mo funciona y por qu√© es importante para el futuro de internet</p>\n          </div>\n        </div>\n      </section>\n\n      <section style="padding: 60px 40px; background: white;">\n        <div style="max-width: 900px; margin: 0 auto;">\n          <h3 style="font-size: 32px; font-weight: bold; margin: 0 0 40px 0; color: #1e293b;">Todos los art√≠culos</h3>\n          <article style="padding: 30px; border-bottom: 1px solid #e2e8f0;">\n            <h4 style="font-size: 20px; font-weight: bold; margin: 0 0 12px 0; color: #1e293b;">Gu√≠a completa de JavaScript</h4>\n            <p style="color: #64748b; margin: 0;">Aprende los conceptos fundamentales del lenguaje</p>\n          </article>\n        </div>\n      </section>\n\n      <footer style="background: #1e293b; color: white; padding: 40px 20px; text-align: center;">\n        <p style="margin: 0; color: #94a3b8;">&copy; 2025 Mi Blog. Todos los derechos reservados.</p>\n      </footer>'},{id:"contacto",nombre:"P√°gina de Contacto",descripcion:"Formulario de contacto profesional con informaci√≥n",categoria:"servicios",emoji:"üìß",contenido_html:'<header style="background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%); color: white; padding: 60px 40px; text-align: center;">\n        <h1 style="font-size: 40px; font-weight: bold; margin: 0 0 12px 0;">Contacta con nosotros</h1>\n        <p style="font-size: 18px; margin: 0; opacity: 0.95;">Estamos aqu√≠ para responder tus preguntas y ayudarte</p>\n      </header>\n\n      <section style="padding: 80px 40px; background: white;">\n        <div style="max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 1fr; gap: 60px;">\n          <div>\n            <h2 style="font-size: 28px; font-weight: bold; margin: 0 0 30px 0; color: #1e293b;">Env√≠anos un mensaje</h2>\n            <form style="display: flex; flex-direction: column; gap: 20px;">\n              <input type="text" placeholder="Tu nombre" style="padding: 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 14px;">\n              <input type="email" placeholder="tu@email.com" style="padding: 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 14px;">\n              <textarea placeholder="Cu√©ntanos m√°s..." style="padding: 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 14px; min-height: 150px;"></textarea>\n              <button type="submit" style="padding: 12px; background: #0891b2; color: white; border: none; border-radius: 6px; font-weight: bold; font-size: 16px; cursor: pointer;">Enviar mensaje</button>\n            </form>\n          </div>\n\n          <div>\n            <h2 style="font-size: 28px; font-weight: bold; margin: 0 0 30px 0; color: #1e293b;">Informaci√≥n de contacto</h2>\n            <div style="margin-bottom: 40px;">\n              <h3 style="font-size: 18px; font-weight: bold; margin: 0 0 12px 0; color: #1e293b;">üìç Ubicaci√≥n</h3>\n              <p style="margin: 0; color: #64748b;">Ciudad de M√©xico, CDMX</p>\n            </div>\n            <div>\n              <h3 style="font-size: 18px; font-weight: bold; margin: 0 0 12px 0; color: #1e293b;">üìû Tel√©fono</h3>\n              <p style="margin: 0;"><a href="tel:+525511223344" style="color: #0891b2; text-decoration: none;">+52 55 1122 3344</a></p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <footer style="background: #1e293b; color: white; padding: 40px 20px; text-align: center;">\n        <p style="margin: 0; color: #94a3b8;">&copy; 2025 Tu Empresa. Todos los derechos reservados.</p>\n      </footer>'},{id:"ecommerce",nombre:"Tienda Online",descripcion:"Ecommerce completo con cat√°logo de productos",categoria:"tienda",emoji:"üõí",contenido_html:'<nav style="background: white; padding: 16px 40px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">\n        <h1 style="margin: 0; font-size: 24px; font-weight: bold; color: #dc2626;">TiendaXpress</h1>\n        <div style="display: flex; gap: 20px; align-items: center;">\n          <input type="text" placeholder="Buscar productos..." style="padding: 10px 16px; border: 1px solid #e2e8f0; border-radius: 6px; width: 300px;">\n          <span style="font-weight: bold; cursor: pointer;">üõí Carrito (3)</span>\n        </div>\n      </nav>\n\n      <section style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; padding: 40px; text-align: center;">\n        <h2 style="font-size: 36px; font-weight: bold; margin: 0 0 12px 0;">Env√≠o GRATIS en compras mayores a $500</h2>\n        <p style="font-size: 16px; margin: 0;">V√°lido hasta el 30 de noviembre</p>\n      </section>\n\n      <section style="padding: 40px; background: #f3f4f6;">\n        <div style="max-width: 1200px; margin: 0 auto;">\n          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px;">\n            <div style="background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">\n              <div style="background: #e5e7eb; height: 150px; display: flex; align-items: center; justify-content: center; font-size: 60px;">üì±</div>\n              <div style="padding: 16px;">\n                <h4 style="font-size: 14px; font-weight: bold; margin: 0 0 8px 0;">Smartphone Pro</h4>\n                <div style="font-size: 16px; font-weight: bold; color: #dc2626; margin-bottom: 12px;">$799</div>\n                <button style="width: 100%; padding: 8px; background: #dc2626; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">A√±adir al carrito</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <footer style="background: #1e293b; color: white; padding: 40px 20px; text-align: center;">\n        <p style="margin: 0; color: #94a3b8;">&copy; 2025 TiendaXpress. Todos los derechos reservados.</p>\n      </footer>'}];function h(){const e=document.getElementById("templatesGrid");if(!e)return void console.error("Templates grid not found");const t="todas"===r?c:c.filter(e=>e.categoria===r);console.log("Rendering templates:",t.length),e.innerHTML=t.map(e=>`\n                <div class="template-card" onclick="loadTemplate('${e.id}')">\n                    <div class="template-preview">${e.emoji}</div>\n                    <div class="template-info">\n                        <span class="template-badge badge-${e.categoria}">${e.categoria.toUpperCase()}</span>\n                        <h3>${e.nombre}</h3>\n                        <p>${e.descripcion}</p>\n                        <button class="use-template-btn" onclick="event.stopPropagation(); loadTemplate('${e.id}')">Usar Esta Plantilla</button>\n                    </div>\n                </div>\n            `).join("")}function m(){document.getElementById("canvas").children.length>0&&!confirm("¬øEst√°s seguro? Perder√°s los cambios no guardados.")||document.getElementById("galleryScreen").classList.remove("hidden")}function g(){document.getElementById("galleryScreen").classList.add("hidden")}function y(e){let t;const n="element-"+i++;switch(e){case"contenedor":t=document.createElement("div"),t.style.padding="20px",t.style.border="1px dashed #ccc",t.style.minHeight="100px",t.textContent="Contenedor";break;case"seccion":t=document.createElement("section"),t.style.padding="40px 20px",t.style.width="100%",t.style.minHeight="200px",t.style.background="#f8fafc",t.textContent="Secci√≥n";break;case"fila":t=document.createElement("div"),t.style.display="flex",t.style.flexDirection="row",t.style.gap="10px",t.style.minHeight="80px",t.style.border="1px dashed #ccc",t.textContent="Fila (Flex)";break;case"columna":t=document.createElement("div"),t.style.display="flex",t.style.flexDirection="column",t.style.gap="10px",t.style.minHeight="100px",t.style.border="1px dashed #ccc",t.textContent="Columna (Flex)";break;case"grid2":t=document.createElement("div"),t.style.display="grid",t.style.gridTemplateColumns="1fr 1fr",t.style.gap="10px",t.style.minHeight="100px",t.style.border="1px dashed #ccc",t.innerHTML='<div style="padding: 20px; background: #f1f5f9;">Columna 1</div><div style="padding: 20px; background: #f1f5f9;">Columna 2</div>';break;case"grid3":t=document.createElement("div"),t.style.display="grid",t.style.gridTemplateColumns="1fr 1fr 1fr",t.style.gap="10px",t.style.minHeight="100px",t.style.border="1px dashed #ccc",t.innerHTML='<div style="padding: 20px; background: #f1f5f9;">Columna 1</div><div style="padding: 20px; background: #f1f5f9;">Columna 2</div><div style="padding: 20px; background: #f1f5f9;">Columna 3</div>';break;case"h1":t=document.createElement("h1"),t.textContent="T√≠tulo Principal",t.style.fontSize="2.5rem",t.style.fontWeight="bold",t.style.margin="0";break;case"h2":t=document.createElement("h2"),t.textContent="Subt√≠tulo",t.style.fontSize="2rem",t.style.fontWeight="bold",t.style.margin="0";break;case"h3":t=document.createElement("h3"),t.textContent="T√≠tulo H3",t.style.fontSize="1.5rem",t.style.fontWeight="bold",t.style.margin="0";break;case"p":t=document.createElement("p"),t.textContent="Este es un p√°rrafo de ejemplo. Haz doble click para editar el texto.",t.style.fontSize="1rem",t.style.lineHeight="1.6",t.style.margin="0";break;case"span":t=document.createElement("span"),t.textContent="Texto en l√≠nea";break;case"ul":t=document.createElement("ul"),t.innerHTML="<li>Elemento 1</li><li>Elemento 2</li><li>Elemento 3</li>",t.style.paddingLeft="20px";break;case"ol":t=document.createElement("ol"),t.innerHTML="<li>Elemento 1</li><li>Elemento 2</li><li>Elemento 3</li>",t.style.paddingLeft="20px";break;case"img":t=document.createElement("img"),t.src="https://via.placeholder.com/400x200",t.alt="Imagen",t.style.maxWidth="100%",t.style.display="block";break;case"video":t=document.createElement("video"),t.controls=!0,t.style.width="100%",t.style.maxWidth="600px",t.innerHTML='<source src="" type="video/mp4">';break;case"iframe":t=document.createElement("iframe"),t.src="",t.style.width="100%",t.style.height="400px",t.style.border="1px solid #ccc";break;case"input":t=document.createElement("input"),t.type="text",t.placeholder="Escribe aqu√≠...",t.style.padding="10px",t.style.border="1px solid #ccc",t.style.borderRadius="4px",t.style.width="100%";break;case"textarea":t=document.createElement("textarea"),t.placeholder="Escribe aqu√≠...",t.style.padding="10px",t.style.border="1px solid #ccc",t.style.borderRadius="4px",t.style.width="100%",t.style.minHeight="100px",t.style.fontFamily="inherit";break;case"button":t=document.createElement("button"),t.textContent="Bot√≥n",t.style.padding="10px 20px",t.style.background="#64748b",t.style.color="white",t.style.border="none",t.style.borderRadius="6px",t.style.cursor="pointer";break;case"checkbox":t=document.createElement("label"),t.innerHTML='<input type="checkbox" style="margin-right: 8px;">Opci√≥n checkbox',t.style.display="flex",t.style.alignItems="center";break;case"radio":t=document.createElement("label"),t.innerHTML='<input type="radio" name="radio-group" style="margin-right: 8px;">Opci√≥n radio',t.style.display="flex",t.style.alignItems="center";break;case"select":t=document.createElement("select"),t.innerHTML="<option>Opci√≥n 1</option><option>Opci√≥n 2</option><option>Opci√≥n 3</option>",t.style.padding="10px",t.style.border="1px solid #ccc",t.style.borderRadius="4px",t.style.width="100%";break;case"btn-primary":t=document.createElement("button"),t.textContent="Bot√≥n Primario",t.style.padding="12px 24px",t.style.background="#2563eb",t.style.color="white",t.style.border="none",t.style.borderRadius="6px",t.style.cursor="pointer",t.style.fontWeight="500";break;case"btn-secondary":t=document.createElement("button"),t.textContent="Bot√≥n Secundario",t.style.padding="12px 24px",t.style.background="white",t.style.color="#1e293b",t.style.border="1px solid #e2e8f0",t.style.borderRadius="6px",t.style.cursor="pointer",t.style.fontWeight="500";break;case"card":t=document.createElement("div"),t.className="component-card",t.innerHTML='\n                        <img src="https://via.placeholder.com/400x200" alt="Card image" style="width: 100%; border-radius: 8px 8px 0 0;">\n                        <div class="component-card-body">\n                            <h3 style="margin: 0 0 10px 0;">T√≠tulo de la Card</h3>\n                            <p style="margin: 0 0 15px 0; color: #64748b;">Descripci√≥n de la tarjeta con informaci√≥n relevante.</p>\n                            <button style="background: #2563eb; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Leer m√°s</button>\n                        </div>\n                    ';break;case"navbar":t=document.createElement("nav"),t.className="component-navbar",t.innerHTML='\n                        <div class="component-navbar-brand">Logo</div>\n                        <ul class="component-navbar-nav">\n                            <li><a href="#">Inicio</a></li>\n                            <li><a href="#">Servicios</a></li>\n                            <li><a href="#">Contacto</a></li>\n                        </ul>\n                    ',t.style.width="100%";break;case"footer":t=document.createElement("footer"),t.className="component-footer",t.innerHTML='\n                        <p style="margin: 0 0 10px 0;">&copy; 2025 Mi Sitio Web</p>\n                        <p style="margin: 0; color: #94a3b8;">Todos los derechos reservados</p>\n                    ',t.style.width="100%";break;case"hero":t=document.createElement("section"),t.className="component-hero",t.innerHTML='\n                        <h1 style="margin: 0 0 20px 0; font-size: 3rem;">Bienvenido</h1>\n                        <p style="margin: 0 0 30px 0; font-size: 1.25rem; max-width: 600px;">Crea p√°ginas web incre√≠bles con nuestro editor visual</p>\n                        <button style="background: white; color: #667eea; padding: 12px 32px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 1rem;">Comenzar</button>\n                    ',t.style.width="100%";break;case"tabs":t=document.createElement("div"),t.innerHTML='\n                        <div class="tabs-container" style="width: 100%;">\n                            <div class="tabs-nav" style="display: flex; border-bottom: 1px solid #e2e8f0;">\n                                <button class="tab-btn active" style="padding: 12px 20px; border: none; background: #f1f5f9; cursor: pointer; border-bottom: 2px solid #2563eb; font-weight: 500; color: #2563eb;">Pesta√±a 1</button>\n                                <button class="tab-btn" style="padding: 12px 20px; border: none; background: transparent; cursor: pointer; border-bottom: 2px solid transparent;">Pesta√±a 2</button>\n                                <button class="tab-btn" style="padding: 12px 20px; border: none; background: transparent; cursor: pointer; border-bottom: 2px solid transparent;">Pesta√±a 3</button>\n                            </div>\n                            <div class="tab-content" style="padding: 20px; border: 1px solid #e2e8f0; border-top: none;">\n                                <p>Contenido de la primera pesta√±a</p>\n                            </div>\n                        </div>\n                    ',t.style.width="100%";break;case"accordion":t=document.createElement("div"),t.innerHTML='\n                        <div class="accordion-item" style="border: 1px solid #e2e8f0; border-bottom: none;">\n                            <div class="accordion-header" style="padding: 16px 20px; background: #f8fafc; cursor: pointer; font-weight: 500; border-bottom: 1px solid #e2e8f0;">\n                                <span style="display: flex; justify-content: space-between; align-items: center; width: 100%;">Pregunta frecuente 1</span>\n                            </div>\n                            <div class="accordion-content" style="padding: 20px; display: block;">\n                                <p>Respuesta a la primera pregunta frecuente.</p>\n                            </div>\n                        </div>\n                        <div class="accordion-item" style="border: 1px solid #e2e8f0; border-bottom: none;">\n                            <div class="accordion-header" style="padding: 16px 20px; background: #f8fafc; cursor: pointer; font-weight: 500; border-bottom: 1px solid #e2e8f0;">\n                                <span style="display: flex; justify-content: space-between; align-items: center; width: 100%;">Pregunta frecuente 2</span>\n                            </div>\n                            <div class="accordion-content" style="padding: 20px; display: none;">\n                                <p>Respuesta a la segunda pregunta frecuente.</p>\n                            </div>\n                        </div>\n                    ',t.style.width="100%";break;case"modal":t=document.createElement("div"),t.innerHTML='\n                        <button class="modal-trigger" style="padding: 12px 24px; background: #2563eb; color: white; border: none; border-radius: 6px; cursor: pointer;">Abrir Modal</button>\n                        <div class="modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 1000;">\n                            <div class="modal-content" style="background: white; padding: 30px; border-radius: 8px; width: 500px; position: relative; max-width: 90%;">\n                                <button class="modal-close" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>\n                                <h3 style="margin: 0 0 15px 0;">T√≠tulo del Modal</h3>\n                                <p style="margin: 0 0 20px 0;">Contenido del modal aqu√≠.</p>\n                                <button class="modal-btn" style="padding: 8px 16px; background: #2563eb; color: white; border: none; border-radius: 4px; cursor: pointer;">Aceptar</button>\n                            </div>\n                        </div>\n                    ';break;case"carousel":t=document.createElement("div"),t.innerHTML='\n                        <div class="carousel-container" style="width: 100%; overflow: hidden; position: relative;">\n                            <div class="carousel-slides" style="display: flex; transition: transform 0.3s ease;">\n                                <div style="min-width: 100%; padding: 20px; text-align: center; background: #f1f5f9;">\n                                    <h4>Diapositiva 1</h4>\n                                    <p>Contenido de la primera diapositiva</p>\n                                </div>\n                                <div style="min-width: 100%; padding: 20px; text-align: center; background: #e2e8f0;">\n                                    <h4>Diapositiva 2</h4>\n                                    <p>Contenido de la segunda diapositiva</p>\n                                </div>\n                                <div style="min-width: 100%; padding: 20px; text-align: center; background: #cbd5e1;">\n                                    <h4>Diapositiva 3</h4>\n                                    <p>Contenido de la tercera diapositiva</p>\n                                </div>\n                            </div>\n                            <button class="carousel-prev" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: white; border: 1px solid #cbd5e1; border-radius: 50%; width: 40px; height: 40px; cursor: pointer;">‚Üê</button>\n                            <button class="carousel-next" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: white; border: 1px solid #cbd5e1; border-radius: 50%; width: 40px; height: 40px; cursor: pointer;">‚Üí</button>\n                        </div>\n                    ',t.style.width="100%";break;case"alert":t=document.createElement("div"),t.innerHTML='\n                        <div class="alert alert-info" style="padding: 16px; border-radius: 6px; border-left: 4px solid #3b82f6; background: #dbeafe; color: #1e3a8a; display: flex; align-items: center;">\n                            <span style="margin-right: 12px;">‚ÑπÔ∏è</span>\n                            <span>Este es un mensaje de informaci√≥n</span>\n                        </div>\n                    ',t.style.width="100%";break;case"badge":t=document.createElement("span"),t.innerHTML="Badge",t.style.backgroundColor="#2563eb",t.style.color="white",t.style.padding="4px 12px",t.style.borderRadius="12px",t.style.fontSize="12px",t.style.fontWeight="bold";break;default:t=document.createElement("div"),t.textContent="Elemento"}t.id=n,t.classList.add("canvas-element"),t.setAttribute("data-component-type",e);const o=document.createElement("div");return o.className="delete-btn",o.textContent="√ó",o.onclick=function(e){e.stopPropagation(),E(t)},t.appendChild(o),t.addEventListener("click",function(e){e.stopPropagation(),x(t)}),t.addEventListener("dblclick",function(e){e.stopPropagation(),w(t)}),f(t),"tabs"===e?function(e){const t=e.querySelectorAll(".tab-btn");t.forEach((e,n)=>{e.addEventListener("click",function(){t.forEach(e=>e.classList.remove("active")),this.classList.add("active")})})}(t):"accordion"===e?function(e){const t=e.querySelectorAll(".accordion-header");t.forEach(e=>{e.addEventListener("click",function(){const e=this.nextElementSibling;"none"===e.style.display||""===e.style.display?e.style.display="block":e.style.display="none"})})}(t):"modal"===e?function(e){const t=e.querySelector(".modal"),n=e.querySelector(".modal-trigger"),o=e.querySelector(".modal-close"),i=e.querySelector(".modal-btn");function r(){t.style.display="none"}n.addEventListener("click",function(e){e.stopPropagation(),t.style.display="flex"}),o.addEventListener("click",r),i.addEventListener("click",r),t.addEventListener("click",function(e){e.target===t&&r()})}(t):"carousel"===e&&function(e){const t=e.querySelector(".carousel-slides"),n=e.querySelector(".carousel-prev"),o=e.querySelector(".carousel-next");let i=0;const r=e.querySelectorAll(".carousel-slides > div");function a(){t.style.transform=`translateX(-${100*i}%)`}n.addEventListener("click",function(e){e.stopPropagation(),i>0&&(i--,a())}),o.addEventListener("click",function(e){e.stopPropagation(),i<r.length-1&&(i++,a())})}(t),t}document.addEventListener("DOMContentLoaded",function(){console.log("DOM Content Loaded - Starting initialization"),console.log("Templates array length:",c.length),function(){try{a=new FileLoader,s=new ProjectManager,l=new ComponentExtractor,window.fileLoader=a,window.projectManager=s,window.componentExtractor=l,console.log("Nuevos m√≥dulos inicializados correctamente")}catch(e){console.error("Error inicializando m√≥dulos:",e)}}(),document.querySelectorAll(".component-item").forEach(e=>{const t=e.getAttribute("data-type");window.enhancedDragDrop?window.enhancedDragDrop.setupComponentDrag(e,t):(e.addEventListener("dragstart",function(e){o=t,e.dataTransfer.effectAllowed="copy",this.classList.add("dragging");const n=document.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.dataTransfer.setDragImage(n,0,0)}),e.addEventListener("dragend",function(){this.classList.remove("dragging")}))}),function(){const e=document.getElementById("canvas");e.addEventListener("dragover",function(t){t.preventDefault(),t.dataTransfer.dropEffect="copy",e.classList.add("drop-zone")}),e.addEventListener("dragleave",function(t){e.classList.remove("drop-zone")}),e.addEventListener("drop",function(t){if(t.preventDefault(),e.classList.remove("drop-zone"),o){const t=y(o);e.appendChild(t),o=null}})}(),function(){const e=document.getElementById("canvas");e.addEventListener("dragover",function(e){v&&(e.preventDefault(),e.dataTransfer.dropEffect="move")}),e.addEventListener("drop",function(t){v&&(t.preventDefault(),t.target===e&&(e.appendChild(v),x(v),L("Elemento movido al final")))})}(),document.addEventListener("keydown",function(e){"Delete"===e.key&&n&&E(n),e.ctrlKey&&"s"===e.key&&(e.preventDefault(),T())}),document.getElementById("canvas").addEventListener("click",function(e){"canvas"===e.target.id&&(n&&(n.classList.remove("selected"),n=null),document.getElementById("propertiesPanel").innerHTML='\n                        <h2 class="panel-title">Propiedades</h2>\n                        <div class="properties-empty">\n                            ‚Üê Arrastra componentes al canvas o selecciona un elemento para editar sus propiedades\n                        </div>\n                    ')}),document.getElementById("componentSearch").addEventListener("input",function(){const e=this.value.toLowerCase();document.querySelectorAll(".component-item").forEach(t=>{const n=t.textContent.toLowerCase(),o=t.getAttribute("data-type").toLowerCase();n.includes(e)||o.includes(e)?t.style.display="block":t.style.display="none"}),document.querySelectorAll(".component-category").forEach(e=>{0===e.querySelectorAll('.component-item[style*="display: block"], .component-item:not([style*="display"])').length?e.style.display="none":e.style.display="block"})}),h(),console.log("Templates rendered"),m(),console.log("Gallery shown")});let v=null,b=null;function f(e){e.draggable=!0,e.addEventListener("dragstart",function(t){if(!e.classList.contains("selected"))return void t.preventDefault();v=e,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",e.outerHTML),e.classList.add("dragging-canvas-element"),b||(b=document.createElement("div"),b.className="drop-indicator",b.style.cssText="\n                    position: absolute;\n                    height: 3px;\n                    background: #3b82f6;\n                    border-radius: 2px;\n                    z-index: 1000;\n                    display: none;\n                    box-shadow: 0 0 6px rgba(59, 130, 246, 0.5);\n                ",document.body.appendChild(b));const n=document.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.dataTransfer.setDragImage(n,0,0)}),e.addEventListener("dragend",function(t){e.classList.remove("dragging-canvas-element"),v=null,b&&(b.remove(),b=null),document.querySelectorAll(".canvas-element").forEach(e=>{e.classList.remove("drop-zone-active")})}),e.addEventListener("dragover",function(t){if(v&&v!==e){t.preventDefault(),t.dataTransfer.dropEffect="move";const n=e.getBoundingClientRect(),o=n.top+n.height/2,i=t.clientY>o;!function(e,t){if(!b)return;const n=e.getBoundingClientRect(),o=document.getElementById("canvas").getBoundingClientRect();b.style.display="block",b.style.left=n.left-o.left+10+"px",b.style.width=n.width-20+"px",b.style.top=t?n.bottom-o.top-1+"px":n.top-o.top-2+"px"}(e,i)}}),e.addEventListener("dragleave",function(t){const n=e.getBoundingClientRect();(t.clientX<n.left||t.clientX>n.right||t.clientY<n.top||t.clientY>n.bottom)&&b&&(b.style.display="none")}),e.addEventListener("drop",function(t){if(v&&v!==e){t.preventDefault(),t.stopPropagation();const n=e.getBoundingClientRect(),o=n.top+n.height/2,i=t.clientY>o;!function(e,t,n){const o=t.parentNode;!function(e,t){let n=t.parentNode;for(;null!=n;){if(n===e)return!0;n=n.parentNode}return!1}(e,t)?(n?t.nextSibling?o.insertBefore(e,t.nextSibling):o.appendChild(e):o.insertBefore(e,t),x(e)):L("No se puede mover un elemento dentro de s√≠ mismo")}(v,e,i),L("Elemento movido")}})}function x(e){n&&(n.classList.remove("selected"),window.resizeManager&&window.resizeManager.disableResize(n)),n=e,e.classList.add("selected"),window.resizeManager&&window.resizeManager.enableResize(e),window.enhancedDragDrop&&window.enhancedDragDrop.setupCanvasElementDrag(e),window.geminiValidator&&window.geminiValidator.isEnabled()&&function(e){u(this,null,function*(){var t;try{const n=yield window.geminiValidator.validateElement(e,{parent:(null==(t=e.parentElement)?void 0:t.tagName)||"body"});n&&n.hasChanges&&window.geminiValidator.showCorrectionSuggestion(e,n)}catch(n){console.error("Error validando sintaxis:",n)}})}(e),function(e){const t=document.getElementById("propertiesPanel"),n=e.tagName.toLowerCase();window.getComputedStyle(e);let o='<h2 class="panel-title">Propiedades</h2>';o+='<div class="property-section">',o+='<div class="section-title">General</div>',o+=`<div class="property-group">\n                        <label class="property-label">Tag HTML</label>\n                        <input class="property-input" value="${n}" readonly>\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">ID</label>\n                        <input class="property-input" value="${e.id}" onchange="updateAttribute('id', this.value)">\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">Clases CSS</label>\n                        <input class="property-input" value="${e.className.replace("canvas-element","").replace("selected","").trim()}" onchange="updateAttribute('class', this.value)">\n                     </div>`,o+="</div>",o+='<div class="property-section">',o+='<div class="section-title">Dimensiones</div>',o+=`<div class="property-grid">\n                        <div class="property-group">\n                            <label class="property-label">Ancho</label>\n                            <input class="property-input" value="${e.style.width||"auto"}" onchange="updateStyle('width', this.value)">\n                        </div>\n                        <div class="property-group">\n                            <label class="property-label">Alto</label>\n                            <input class="property-input" value="${e.style.height||"auto"}" onchange="updateStyle('height', this.value)">\n                        </div>\n                     </div>`,o+=`<div class="property-grid">\n                        <div class="property-group">\n                            <label class="property-label">Ancho M√°ximo</label>\n                            <input class="property-input" value="${e.style.maxWidth||""}" onchange="updateStyle('maxWidth', this.value)">\n                        </div>\n                        <div class="property-group">\n                            <label class="property-label">Alto M√°ximo</label>\n                            <input class="property-input" value="${e.style.maxHeight||""}" onchange="updateStyle('maxHeight', this.value)">\n                        </div>\n                     </div>`,o+="</div>",o+='<div class="property-section">',o+='<div class="section-title">Espaciado</div>',o+='<div class="property-group">',o+='<label class="property-label">Padding (px)</label>',o+='<div class="property-grid-4">',o+=`<input class="property-input" placeholder="Top" value="${e.style.paddingTop.replace("px","")}" onchange="updateStyle('paddingTop', this.value + 'px')">`,o+=`<input class="property-input" placeholder="Right" value="${e.style.paddingRight.replace("px","")}" onchange="updateStyle('paddingRight', this.value + 'px')">`,o+=`<input class="property-input" placeholder="Bottom" value="${e.style.paddingBottom.replace("px","")}" onchange="updateStyle('paddingBottom', this.value + 'px')">`,o+=`<input class="property-input" placeholder="Left" value="${e.style.paddingLeft.replace("px","")}" onchange="updateStyle('paddingLeft', this.value + 'px')">`,o+="</div></div>",o+='<div class="property-group">',o+='<label class="property-label">Margin (px)</label>',o+='<div class="property-grid-4">',o+=`<input class="property-input" placeholder="Top" value="${e.style.marginTop.replace("px","")}" onchange="updateStyle('marginTop', this.value + 'px')">`,o+=`<input class="property-input" placeholder="Right" value="${e.style.marginRight.replace("px","")}" onchange="updateStyle('marginRight', this.value + 'px')">`,o+=`<input class="property-input" placeholder="Bottom" value="${e.style.marginBottom.replace("px","")}" onchange="updateStyle('marginBottom', this.value + 'px')">`,o+=`<input class="property-input" placeholder="Left" value="${e.style.marginLeft.replace("px","")}" onchange="updateStyle('marginLeft', this.value + 'px')">`,o+="</div></div>",o+="</div>",o+='<div class="property-section">',o+='<div class="section-title">Posicionamiento</div>',o+=`<div class="property-group">\n                        <label class="property-label">Display</label>\n                        <select class="property-input" onchange="updateStyle('display', this.value)">\n                            <option value="block" ${"block"===e.style.display?"selected":""}>Block</option>\n                            <option value="inline-block" ${"inline-block"===e.style.display?"selected":""}>Inline-block</option>\n                            <option value="flex" ${"flex"===e.style.display?"selected":""}>Flex</option>\n                            <option value="grid" ${"grid"===e.style.display?"selected":""}>Grid</option>\n                            <option value="none" ${"none"===e.style.display?"selected":""}>None</option>\n                        </select>\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">Position</label>\n                        <select class="property-input" onchange="updateStyle('position', this.value)">\n                            <option value="static" ${"static"!==e.style.position&&e.style.position?"":"selected"}>Static</option>\n                            <option value="relative" ${"relative"===e.style.position?"selected":""}>Relative</option>\n                            <option value="absolute" ${"absolute"===e.style.position?"selected":""}>Absolute</option>\n                            <option value="fixed" ${"fixed"===e.style.position?"selected":""}>Fixed</option>\n                        </select>\n                     </div>`,o+="</div>",["h1","h2","h3","h4","h5","h6","p","span","a","button","label"].includes(n)&&(o+='<div class="property-section">',o+='<div class="section-title">Tipograf√≠a</div>',o+=`<div class="property-group">\n                            <label class="property-label">Font Size</label>\n                            <input class="property-input" value="${e.style.fontSize||""}" onchange="updateStyle('fontSize', this.value)">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Font Weight</label>\n                            <select class="property-input" onchange="updateStyle('fontWeight', this.value)">\n                                <option value="normal" ${"normal"===e.style.fontWeight||"400"===e.style.fontWeight?"selected":""}>Normal</option>\n                                <option value="500" ${"500"===e.style.fontWeight?"selected":""}>Medium</option>\n                                <option value="600" ${"600"===e.style.fontWeight?"selected":""}>Semibold</option>\n                                <option value="bold" ${"bold"===e.style.fontWeight||"700"===e.style.fontWeight?"selected":""}>Bold</option>\n                            </select>\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Color</label>\n                            <input type="color" class="property-input" value="${P(e.style.color||"#000000")}" onchange="updateStyle('color', this.value)">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Text Align</label>\n                            <div class="text-align-buttons">\n                                <button class="text-align-btn ${"left"===e.style.textAlign?"active":""}" onclick="updateStyle('textAlign', 'left')">L</button>\n                                <button class="text-align-btn ${"center"===e.style.textAlign?"active":""}" onclick="updateStyle('textAlign', 'center')">C</button>\n                                <button class="text-align-btn ${"right"===e.style.textAlign?"active":""}" onclick="updateStyle('textAlign', 'right')">R</button>\n                                <button class="text-align-btn ${"justify"===e.style.textAlign?"active":""}" onclick="updateStyle('textAlign', 'justify')">J</button>\n                            </div>\n                         </div>`,o+="</div>"),o+='<div class="property-section">',o+='<div class="section-title">Fondo y Bordes</div>',o+=`<div class="property-group">\n                        <label class="property-label">Background Color</label>\n                        <input type="color" class="property-input" value="${P(e.style.backgroundColor||"#ffffff")}" onchange="updateStyle('backgroundColor', this.value)">\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">Border Width (px)</label>\n                        <input class="property-input" value="${e.style.borderWidth.replace("px","")}" onchange="updateStyle('borderWidth', this.value + 'px')">\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">Border Style</label>\n                        <select class="property-input" onchange="updateStyle('borderStyle', this.value)">\n                            <option value="none" ${"none"===e.style.borderStyle?"selected":""}>None</option>\n                            <option value="solid" ${"solid"===e.style.borderStyle?"selected":""}>Solid</option>\n                            <option value="dashed" ${"dashed"===e.style.borderStyle?"selected":""}>Dashed</option>\n                            <option value="dotted" ${"dotted"===e.style.borderStyle?"selected":""}>Dotted</option>\n                        </select>\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">Border Color</label>\n                        <input type="color" class="property-input" value="${P(e.style.borderColor||"#000000")}" onchange="updateStyle('borderColor', this.value)">\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">Border Radius (px)</label>\n                        <input class="property-input" value="${e.style.borderRadius.replace("px","")}" onchange="updateStyle('borderRadius', this.value + 'px')">\n                     </div>`,o+="</div>",o+='<div class="property-section">',o+='<div class="section-title">Sombra y Efectos</div>',o+=`<div class="property-group">\n                        <label class="property-label">Box Shadow</label>\n                        <select class="property-input" onchange="updateStyle('boxShadow', this.value)">\n                            <option value="none" ${"none"===e.style.boxShadow?"selected":""}>Ninguna</option>\n                            <option value="0 1px 3px rgba(0,0,0,0.1)" ${"0 1px 3px rgba(0,0,0,0.1)"===e.style.boxShadow||e.style.boxShadow.includes("0 1px 3px")?"selected":""}>Sutil</option>\n                            <option value="0 2px 6px rgba(0,0,0,0.15)" ${"0 2px 6px rgba(0,0,0,0.15)"===e.style.boxShadow||e.style.boxShadow.includes("0 2px 6px")?"selected":""}>Media</option>\n                            <option value="0 4px 12px rgba(0,0,0,0.15)" ${"0 4px 12px rgba(0,0,0,0.15)"===e.style.boxShadow||e.style.boxShadow.includes("0 4px 12px")?"selected":""}>Fuerte</option>\n                        </select>\n                     </div>`,o+=`<div class="property-group">\n                        <label class="property-label">Opacity</label>\n                        <input type="range" min="0" max="100" value="${e.style.opacity?100*parseFloat(e.style.opacity):"100"}" class="property-input" onchange="updateStyle('opacity', this.value / 100)">\n                        <div style="font-size: 12px; color: #64748b; text-align: right;">${e.style.opacity?Math.round(100*parseFloat(e.style.opacity)):"100"}%</div>\n                     </div>`,o+="</div>","flex"===e.style.display&&(o+='<div class="property-section">',o+='<div class="section-title">Flexbox</div>',o+=`<div class="property-group">\n                            <label class="property-label">Flex Direction</label>\n                            <select class="property-input" onchange="updateStyle('flexDirection', this.value)">\n                                <option value="row" ${"row"===e.style.flexDirection?"selected":""}>Row</option>\n                                <option value="column" ${"column"===e.style.flexDirection?"selected":""}>Column</option>\n                                <option value="row-reverse" ${"row-reverse"===e.style.flexDirection?"selected":""}>Row Reverse</option>\n                                <option value="column-reverse" ${"column-reverse"===e.style.flexDirection?"selected":""}>Column Reverse</option>\n                            </select>\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Justify Content</label>\n                            <select class="property-input" onchange="updateStyle('justifyContent', this.value)">\n                                <option value="flex-start" ${"flex-start"===e.style.justifyContent?"selected":""}>Flex Start</option>\n                                <option value="center" ${"center"===e.style.justifyContent?"selected":""}>Center</option>\n                                <option value="flex-end" ${"flex-end"===e.style.justifyContent?"selected":""}>Flex End</option>\n                                <option value="space-between" ${"space-between"===e.style.justifyContent?"selected":""}>Space Between</option>\n                                <option value="space-around" ${"space-around"===e.style.justifyContent?"selected":""}>Space Around</option>\n                                <option value="space-evenly" ${"space-evenly"===e.style.justifyContent?"selected":""}>Space Evenly</option>\n                            </select>\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Align Items</label>\n                            <select class="property-input" onchange="updateStyle('alignItems', this.value)">\n                                <option value="flex-start" ${"flex-start"===e.style.alignItems?"selected":""}>Flex Start</option>\n                                <option value="center" ${"center"===e.style.alignItems?"selected":""}>Center</option>\n                                <option value="flex-end" ${"flex-end"===e.style.alignItems?"selected":""}>Flex End</option>\n                                <option value="stretch" ${"stretch"===e.style.alignItems?"selected":""}>Stretch</option>\n                                <option value="baseline" ${"baseline"===e.style.alignItems?"selected":""}>Baseline</option>\n                            </select>\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Align Content</label>\n                            <select class="property-input" onchange="updateStyle('alignContent', this.value)">\n                                <option value="flex-start" ${"flex-start"===e.style.alignContent?"selected":""}>Flex Start</option>\n                                <option value="center" ${"center"===e.style.alignContent?"selected":""}>Center</option>\n                                <option value="flex-end" ${"flex-end"===e.style.alignContent?"selected":""}>Flex End</option>\n                                <option value="space-between" ${"space-between"===e.style.alignContent?"selected":""}>Space Between</option>\n                                <option value="space-around" ${"space-around"===e.style.alignContent?"selected":""}>Space Around</option>\n                                <option value="stretch" ${"stretch"===e.style.alignContent?"selected":""}>Stretch</option>\n                            </select>\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Gap (px)</label>\n                            <input class="property-input" value="${e.style.gap.replace("px","")}" onchange="updateStyle('gap', this.value + 'px')">\n                         </div>`,o+="</div>"),"grid"===e.style.display&&(o+='<div class="property-section">',o+='<div class="section-title">Grid</div>',o+=`<div class="property-group">\n                            <label class="property-label">Grid Template Columns</label>\n                            <input class="property-input" value="${e.style.gridTemplateColumns||""}" placeholder="1fr 1fr" onchange="updateStyle('gridTemplateColumns', this.value)">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Grid Template Rows</label>\n                            <input class="property-input" value="${e.style.gridTemplateRows||""}" placeholder="auto auto" onchange="updateStyle('gridTemplateRows', this.value)">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Grid Gap (px)</label>\n                            <input class="property-input" value="${e.style.gridGap.replace("px","")||"0"}" onchange="updateStyle('gridGap', this.value + 'px')">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Justify Items</label>\n                            <select class="property-input" onchange="updateStyle('justifyItems', this.value)">\n                                <option value="stretch" ${"stretch"===e.style.justifyItems?"selected":""}>Stretch</option>\n                                <option value="center" ${"center"===e.style.justifyItems?"selected":""}>Center</option>\n                                <option value="start" ${"start"===e.style.justifyItems?"selected":""}>Start</option>\n                                <option value="end" ${"end"===e.style.justifyItems?"selected":""}>End</option>\n                            </select>\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Align Items</label>\n                            <select class="property-input" onchange="updateStyle('alignItems', this.value)">\n                                <option value="stretch" ${"stretch"===e.style.alignItems?"selected":""}>Stretch</option>\n                                <option value="center" ${"center"===e.style.alignItems?"selected":""}>Center</option>\n                                <option value="start" ${"start"===e.style.alignItems?"selected":""}>Start</option>\n                                <option value="end" ${"end"===e.style.alignItems?"selected":""}>End</option>\n                            </select>\n                         </div>`,o+="</div>"),o+='<div class="property-section">',o+='<div class="section-title">Transiciones</div>',o+=`<div class="property-group">\n                        <label class="property-label">Transition</label>\n                        <select class="property-input" onchange="updateStyle('transition', this.value)">\n                            <option value="" ${e.style.transition?"":"selected"}>Ninguna</option>\n                            <option value="all 0.3s ease" ${"all 0.3s ease"===e.style.transition?"selected":""}>Suave (0.3s)</option>\n                            <option value="all 0.5s ease" ${"all 0.5s ease"===e.style.transition?"selected":""}>Lenta (0.5s)</option>\n                        </select>\n                     </div>`,o+="</div>",o+='<div class="property-section">',o+='<div class="section-title">Atributos</div>',"img"===n?(o+=`<div class="property-group">\n                            <label class="property-label">Src</label>\n                            <input class="property-input" value="${e.src}" onchange="updateAttribute('src', this.value)">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Alt</label>\n                            <input class="property-input" value="${e.alt}" onchange="updateAttribute('alt', this.value)">\n                         </div>`):"a"===n?(o+=`<div class="property-group">\n                            <label class="property-label">Href</label>\n                            <input class="property-input" value="${e.href||""}" onchange="updateAttribute('href', this.value)">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Target</label>\n                            <select class="property-input" onchange="updateAttribute('target', this.value)">\n                                <option value="_self" ${"_self"!==e.target&&e.target?"":"selected"}>Same Window</option>\n                                <option value="_blank" ${"_blank"===e.target?"selected":""}>New Window</option>\n                            </select>\n                         </div>`):"input"===n?(o+=`<div class="property-group">\n                            <label class="property-label">Type</label>\n                            <input class="property-input" value="${e.type}" onchange="updateAttribute('type', this.value)">\n                         </div>`,o+=`<div class="property-group">\n                            <label class="property-label">Placeholder</label>\n                            <input class="property-input" value="${e.placeholder}" onchange="updateAttribute('placeholder', this.value)">\n                         </div>`):"button"===n&&(o+=`<div class="property-group">\n                            <label class="property-label">Type</label>\n                            <select class="property-input" onchange="updateAttribute('type', this.value)">\n                                <option value="button" ${"button"===e.type?"selected":""}>Button</option>\n                                <option value="submit" ${"submit"===e.type?"selected":""}>Submit</option>\n                                <option value="reset" ${"reset"===e.type?"selected":""}>Reset</option>\n                            </select>\n                         </div>`),o+="</div>",t.innerHTML=o}(e)}function w(e){const t=e.tagName.toLowerCase();if(["h1","h2","h3","h4","h5","h6","p","span","button","a","li","label"].includes(t)){e.contentEditable=!0,e.focus();const t=document.createRange();t.selectNodeContents(e);const n=window.getSelection();n.removeAllRanges(),n.addRange(t),e.addEventListener("blur",function(){e.contentEditable=!1},{once:!0}),e.addEventListener("keydown",function(t){"Enter"!==t.key||t.shiftKey||(t.preventDefault(),e.blur())})}}function E(e){n===e&&(n=null,document.getElementById("propertiesPanel").innerHTML='\n                    <h2 class="panel-title">Propiedades</h2>\n                    <div class="properties-empty">\n                        ‚Üê Arrastra componentes al canvas o selecciona un elemento para editar sus propiedades\n                    </div>\n                '),e.remove()}function S(e){const t=document.getElementById("canvasWrapper");t.className="canvas-wrapper",["btnDesktop","btnTablet","btnMobile"].forEach(e=>document.getElementById(e).classList.remove("active")),"tablet"===e?(t.classList.add("tablet"),document.getElementById("btnTablet").classList.add("active")):"mobile"===e?(t.classList.add("mobile"),document.getElementById("btnMobile").classList.add("active")):document.getElementById("btnDesktop").classList.add("active")}function C(e,t){const n=new Blob([t],{type:"text/plain"}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=e,i.click(),URL.revokeObjectURL(o)}function T(){try{I.saveCurrentProject(),L("Proyecto guardado en formato mejorado")}catch(e){console.error("Error al guardar proyecto:",e),L("Error al guardar proyecto")}}function k(e){const t=e.target.files;if(t&&0!==t.length){if(1===t.length&&t[0].name.endsWith(".json")){const e=t[0];return void I.importProject(e).then(e=>{console.log("Proyecto cargado:",e)}).catch(e=>{console.error("Error al cargar proyecto:",e),L("Error al cargar el proyecto")})}if(1===t.length&&(t[0].name.endsWith(".html")||t[0].name.endsWith(".htm"))){const e=t[0];return void A.parseHTMLFile(e).then(e=>{L(I.loadProjectToCanvas(e)?"Archivo HTML convertido y cargado":"Error al cargar el archivo HTML")}).catch(e=>{console.error("Error al parsear HTML:",e),L("Error al procesar el archivo HTML")})}if(a){let e=null;for(let n=0;n<t.length;n++){const o=t[n];(o.name.endsWith(".html")||o.name.endsWith(".htm"))&&(!o.name.toLowerCase().includes("index")&&e||(e=o))}e?A.parseHTMLFile(e).then(e=>{I.loadProjectToCanvas(e)&&L(`Directorio HTML cargado: ${t.length} archivos procesados`)}).catch(e=>{console.error("Error al procesar directorio:",e),L("Error al procesar el directorio")}):L("No se encontr√≥ archivo HTML en el directorio seleccionado")}else L("Selecciona un archivo JSON o HTML individual");e.target.value=""}}function L(e){const t=document.createElement("div");t.className="toast",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.remove()},3e3)}function P(e){if(!e||"transparent"===e)return"#ffffff";if(e.startsWith("#"))return e;const t=e.match(/\d+/g);return t?"#"+[parseInt(t[0]),parseInt(t[1]),parseInt(t[2])].map(e=>{const t=e.toString(16);return 1===t.length?"0"+t:t}).join(""):"#ffffff"}if(void 0!==T){const e=T;window.saveProject=function(){s?s.saveCurrentProject():e()}}if(void 0!==k){const e=k;window.loadProject=function(t){const n=t.target.files[0];n&&(s?s.importProject(n):e(t))}}const A=new class{constructor(){this.elementIdCounter=0}parseHTMLFile(e){return u(this,null,function*(){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>{try{const n=e.target.result,o=this.convertHTMLToJSON(n);t(o)}catch(o){n(o)}},o.onerror=()=>n(new Error("Error al leer el archivo")),o.readAsText(e)})})}convertHTMLToJSON(e){const t=(new DOMParser).parseFromString(e,"text/html"),n=this.extractStyles(t),o=this.extractScripts(t),i=this.extractBodyElements(t);return{version:"2.0",metadata:{title:t.title||"Proyecto Importado",created:(new Date).toISOString(),imported:!0,originalFile:"imported.html"},elements:i,styles:n,scripts:o,canvas:{size:"desktop",selectedElement:null}}}extractStyles(e){const t={inline:{},internal:[],external:[]};return e.querySelectorAll("style").forEach((e,n)=>{t.internal.push({id:`internal-${n}`,content:e.textContent})}),e.querySelectorAll('link[rel="stylesheet"]').forEach((e,n)=>{t.external.push({id:`external-${n}`,href:e.href,media:e.media||"all"})}),t}extractScripts(e){const t={inline:[],external:[]};return e.querySelectorAll("script").forEach((e,n)=>{e.src?t.external.push({id:`external-script-${n}`,src:e.src,async:e.async,defer:e.defer}):e.textContent.trim()&&t.inline.push({id:`inline-script-${n}`,content:e.textContent})}),t}extractBodyElements(e){const t=e.body;if(!t)return[];const n=[];return Array.from(t.children).forEach(e=>{const t=this.buildElementTree(e);t&&n.push(t)}),n}buildElementTree(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return null;const t="imported-element-"+this.elementIdCounter++,n=window.getComputedStyle?this.getRelevantStyles(e):{},o=this.parseInlineStyles(e.style.cssText),i={id:t,tagName:e.tagName.toLowerCase(),textContent:this.getDirectTextContent(e),attributes:this.extractAttributes(e),styles:{inline:o,computed:n},children:[],metadata:{originalId:e.id||null,originalClasses:Array.from(e.classList),canvasElement:!0}};return Array.from(e.children).forEach(e=>{const t=this.buildElementTree(e);t&&i.children.push(t)}),i}getDirectTextContent(e){let t="";for(let n of e.childNodes)n.nodeType===Node.TEXT_NODE&&(t+=n.textContent);return t.trim()}extractAttributes(e){const t={},n=["id","class","src","href","alt","title","data-*","aria-*"];return Array.from(e.attributes).forEach(e=>{const o=e.name,i=e.value;n.some(e=>e.includes("*")?o.startsWith(e.replace("*","")):o===e)&&(t[o]=i)}),t}parseInlineStyles(e){const t={};return e?(e.split(";").forEach(e=>{const n=e.indexOf(":");if(n>0){const o=e.substring(0,n).trim(),i=e.substring(n+1).trim();o&&i&&(t[o]=i)}}),t):t}getRelevantStyles(e){if(!window.getComputedStyle)return{};const t=window.getComputedStyle(e),n={};return["display","position","top","left","right","bottom","width","height","margin","padding","border","background","color","font-family","font-size","font-weight","text-align","line-height","flex","grid","z-index"].forEach(e=>{const o=t.getPropertyValue(e);o&&"initial"!==o&&"normal"!==o&&(n[e]=o)}),n}jsonToCanvas(e){const t=document.getElementById("canvas");t&&(t.innerHTML="",e.elements.forEach(e=>{const n=this.createDOMFromJSON(e);n&&t.appendChild(n)}),this.applyInternalStyles(e.styles),this.reapplyCanvasEvents())}createDOMFromJSON(e){const t=document.createElement(e.tagName);return t.id=e.id,t.classList.add("canvas-element"),e.metadata.originalClasses&&e.metadata.originalClasses.forEach(e=>{t.classList.add(e)}),Object.entries(e.attributes).forEach(([e,n])=>{"id"!==e&&"class"!==e&&t.setAttribute(e,n)}),Object.entries(e.styles.inline).forEach(([e,n])=>{t.style.setProperty(e,n)}),e.textContent&&0===e.children.length&&(t.textContent=e.textContent),e.children.forEach(e=>{const n=this.createDOMFromJSON(e);n&&t.appendChild(n)}),this.addDeleteButton(t),t}applyInternalStyles(e){document.querySelectorAll("style[data-editor-imported]").forEach(e=>e.remove()),e.internal.forEach(e=>{const t=document.createElement("style");t.setAttribute("data-editor-imported","true"),t.textContent=e.content,document.head.appendChild(t)})}addDeleteButton(e){const t=document.createElement("button");t.className="delete-btn",t.innerHTML="√ó",t.onclick=t=>{t.stopPropagation(),e.remove(),n===e&&(n=null,updatePropertiesPanel())},e.appendChild(t)}reapplyCanvasEvents(){document.querySelectorAll(".canvas-element").forEach(e=>{e.addEventListener("click",function(t){t.stopPropagation(),x(e)}),e.addEventListener("dblclick",function(t){t.stopPropagation(),w(e)})})}},I=new class{constructor(){this.currentProject=null,this.projectHistory=[]}createProjectFromCanvas(){const e=document.getElementById("canvas"),t=this.extractElementsFromCanvas(e);return{version:"2.0",metadata:{title:"Proyecto Sin T√≠tulo",created:(new Date).toISOString(),modified:(new Date).toISOString(),canvasSize:this.getCurrentCanvasSize(),selectedElement:n?n.id:null},elements:t,styles:{inline:{},internal:this.extractInternalStyles(),external:[]},scripts:{inline:[],external:[]}}}extractElementsFromCanvas(e){const t=[];return Array.from(e.children).forEach(e=>{if(e.classList.contains("canvas-element")){const n=this.extractElementData(e);t.push(n)}}),t}extractElementData(e){const t={id:e.id,tagName:e.tagName.toLowerCase(),textContent:this.getDirectTextContent(e),attributes:this.extractElementAttributes(e),styles:{inline:this.extractInlineStyles(e),computed:{}},children:[],metadata:{componentType:e.getAttribute("data-component-type")||"custom",canvasElement:!0,draggable:e.draggable}};return Array.from(e.children).forEach(e=>{e.classList.contains("delete-btn")||(e.classList.contains("canvas-element")?t.children.push(this.extractElementData(e)):t.children.push({id:`child-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,tagName:e.tagName.toLowerCase(),textContent:e.textContent,attributes:this.extractElementAttributes(e),styles:{inline:this.extractInlineStyles(e),computed:{}},children:[],metadata:{canvasElement:!1}}))}),t}getDirectTextContent(e){let t="";for(let n of e.childNodes)n.nodeType===Node.TEXT_NODE&&(t+=n.textContent);return t.trim()}extractElementAttributes(e){const t={};return Array.from(e.attributes).forEach(e=>{"draggable"!==e.name&&"data-component-type"!==e.name&&(t[e.name]=e.value)}),t}extractInlineStyles(e){const t={};return e.style.cssText&&e.style.cssText.split(";").forEach(e=>{const n=e.indexOf(":");if(n>0){const o=e.substring(0,n).trim(),i=e.substring(n+1).trim();o&&i&&(t[o]=i)}}),t}extractInternalStyles(){const e=[];return document.querySelectorAll("style[data-editor-imported]").forEach((t,n)=>{e.push({id:`internal-${n}`,content:t.textContent})}),e}getCurrentCanvasSize(){document.getElementById("canvas");const e=document.querySelector(".toolbar-btn.active");if(e){if("btnDesktop"===e.id)return"desktop";if("btnTablet"===e.id)return"tablet";if("btnMobile"===e.id)return"mobile"}return"desktop"}loadProjectToCanvas(e){const t=document.getElementById("canvas");return e.version&&"1.0"!==e.version?(t.innerHTML="",e.elements&&e.elements.forEach(e=>{const n=this.createDOMFromElementData(e);n&&t.appendChild(n)}),e.styles&&e.styles.internal&&this.applyInternalStyles(e.styles.internal),e.metadata&&e.metadata.canvasSize&&S(e.metadata.canvasSize),this.reapplyCanvasEvents(),this.currentProject=e,!0):this.loadLegacyProject(e)}createDOMFromElementData(e){const t=document.createElement(e.tagName);return t.id=e.id,t.classList.add("canvas-element"),Object.entries(e.attributes).forEach(([e,n])=>{"id"!==e&&t.setAttribute(e,n)}),Object.entries(e.styles.inline).forEach(([e,n])=>{t.style.setProperty(e,n)}),e.metadata.componentType&&t.setAttribute("data-component-type",e.metadata.componentType),e.metadata.draggable&&(t.draggable=!0),e.textContent&&0===e.children.length&&(t.textContent=e.textContent),e.children.forEach(e=>{const n=this.createDOMFromElementData(e);n&&t.appendChild(n)}),!1!==e.metadata.canvasElement&&(this.addDeleteButton(t),this.addElementEvents(t)),t}addDeleteButton(e){const t=document.createElement("div");t.className="delete-btn",t.textContent="√ó",t.onclick=t=>{t.stopPropagation(),E(e)},e.appendChild(t)}addElementEvents(e){e.addEventListener("click",function(t){t.stopPropagation(),x(e)}),e.addEventListener("dblclick",function(t){t.stopPropagation(),w(e)}),f(e)}applyInternalStyles(e){document.querySelectorAll("style[data-editor-imported]").forEach(e=>e.remove()),e.forEach(e=>{const t=document.createElement("style");t.setAttribute("data-editor-imported","true"),t.textContent=e.content,document.head.appendChild(t)})}reapplyCanvasEvents(){document.querySelectorAll(".canvas-element").forEach(e=>{})}loadLegacyProject(e){return document.getElementById("canvas").innerHTML=e.html,document.querySelectorAll(".canvas-element").forEach(e=>{this.addElementEvents(e);const t=e.querySelector(".delete-btn");t&&(t.onclick=function(t){t.stopPropagation(),E(e)})}),!0}saveCurrentProject(e="proyecto.json"){const t=this.createProjectFromCanvas();return this.downloadProject(t,e),this.currentProject=t,t}downloadProject(e,t){const n=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=t,i.click(),URL.revokeObjectURL(o)}importProject(e){return u(this,null,function*(){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>{try{const o=JSON.parse(e.target.result);this.loadProjectToCanvas(o)?(L("Proyecto cargado correctamente"),t(o)):n(new Error("Error al cargar el proyecto"))}catch(o){n(o)}},o.onerror=()=>n(new Error("Error al leer el archivo")),o.readAsText(e)})})}};window.startBlankProject=function(){console.log("startBlankProject called"),document.getElementById("canvas").innerHTML="",n=null,document.getElementById("propertiesPanel").innerHTML='\n                <h2 class="panel-title">Propiedades</h2>\n                <div class="properties-empty">\n                    ‚Üê Arrastra componentes al canvas o selecciona un elemento para editar sus propiedades\n                </div>\n            ',g(),L("Nuevo proyecto en blanco creado")},window.loadTemplate=function(e){const t=c.find(t=>t.id===e);if(!t)return;const n=document.getElementById("canvas");n.innerHTML=t.contenido_html,n.querySelectorAll("*").forEach((e,t)=>{if("canvas"===e.id)return;e.id="element-"+i++,e.classList.add("canvas-element");const n=document.createElement("div");n.className="delete-btn",n.textContent="√ó",n.onclick=function(t){t.stopPropagation(),E(e)},e.appendChild(n),e.addEventListener("click",function(t){t.stopPropagation(),x(e)}),e.addEventListener("dblclick",function(t){t.stopPropagation(),w(e)}),f(e)}),g(),L('Plantilla "'+t.nombre+'" cargada')},window.filterTemplates=function(e){r=e,document.querySelectorAll(".category-btn").forEach(e=>{e.classList.remove("active")}),event.target.classList.add("active"),h()},window.showGallery=m,window.hideGallery=g,window.newProject=function(){confirm("¬øEst√°s seguro de que quieres crear un nuevo proyecto? Se perder√°n los cambios no guardados.")&&(document.getElementById("canvas").innerHTML="",n=null,document.getElementById("propertiesPanel").innerHTML='\n                    <h2 class="panel-title">Propiedades</h2>\n                    <div class="properties-empty">\n                        ‚Üê Arrastra componentes al canvas o selecciona un elemento para editar sus propiedades\n                    </div>\n                ',L("Proyecto nuevo creado"))},window.setCanvasSize=S,window.exportHTML=function(){const e=document.getElementById("canvas").cloneNode(!0);e.querySelectorAll(".canvas-element").forEach(e=>{e.classList.remove("canvas-element","selected");const t=e.querySelector(".delete-btn");t&&t.remove(),e.removeAttribute("draggable"),e.removeAttribute("data-component-type")});const t=`<!DOCTYPE html>\n<html lang="es">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Mi P√°gina Web</title>\n    <link rel="stylesheet" href="styles.css">\n</head>\n<body>\n${e.innerHTML}\n</body>\n</html>`,n=new Blob([t],{type:"text/html"}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download="index.html",i.click(),URL.revokeObjectURL(o),L("HTML exportado correctamente")},window.exportZip=function(){const e=document.getElementById("canvas").cloneNode(!0);e.querySelectorAll(".canvas-element").forEach(e=>{e.classList.remove("canvas-element","selected");const t=e.querySelector(".delete-btn");t&&t.remove(),e.removeAttribute("draggable"),e.removeAttribute("data-component-type")}),C("index.html",`<!DOCTYPE html>\n<html lang="es">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Mi P√°gina Web</title>\n    <link rel="stylesheet" href="styles.css">\n    <script src="script.js"><\/script>\n</head>\n<body>\n${e.innerHTML}\n</body>\n</html>`),C("styles.css","* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: system-ui, -apple-system, sans-serif;\n}\n\n/* Estilos de componentes */\n.component-card {\n    border: 1px solid #e2e8f0;\n    border-radius: 8px;\n    background: white;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n    max-width: 400px;\n}\n\n.component-card img {\n    width: 100%;\n    border-radius: 8px 8px 0 0;\n}\n\n.component-card-body {\n    padding: 20px;\n}\n\n.component-navbar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 16px 32px;\n    background: #1e293b;\n    color: white;\n}\n\n.component-navbar-brand {\n    font-size: 1.5rem;\n    font-weight: bold;\n}\n\n.component-navbar-nav {\n    display: flex;\n    gap: 20px;\n    list-style: none;\n}\n\n.component-navbar-nav a {\n    color: white;\n    text-decoration: none;\n}\n\n.component-hero {\n    min-height: 400px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    text-align: center;\n    padding: 60px 20px;\n}\n\n.component-footer {\n    background: #1e293b;\n    color: white;\n    padding: 40px 20px;\n    text-align: center;\n}\n\n/* Estilos de componentes adicionales */\n.tabs-container {\n    border: 1px solid #e2e8f0;\n    border-radius: 6px;\n    overflow: hidden;\n}\n\n.tab-btn {\n    border: none;\n    background: transparent;\n    padding: 12px 20px;\n    cursor: pointer;\n    font-weight: 500;\n}\n\n.tab-btn.active {\n    border-bottom: 2px solid #2563eb;\n    color: #2563eb;\n    background: #f1f5f9;\n}\n\n.accordion-header {\n    background: #f8fafc;\n    padding: 16px 20px;\n    cursor: pointer;\n    border-bottom: 1px solid #e2e8f0;\n    font-weight: 500;\n}\n\n.accordion-content {\n    padding: 20px;\n}\n\n.modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0,0,0,0.5);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n}\n\n.modal-content {\n    background: white;\n    padding: 30px;\n    border-radius: 8px;\n    width: 500px;\n    position: relative;\n    max-width: 90%;\n}\n\n.modal-close {\n    position: absolute;\n    top: 10px;\n    right: 15px;\n    background: none;\n    border: none;\n    font-size: 24px;\n    cursor: pointer;\n}\n\n.carousel-container {\n    overflow: hidden;\n    position: relative;\n    border-radius: 8px;\n    box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n}\n\n.carousel-slides {\n    display: flex;\n    transition: transform 0.3s ease;\n}\n\n.carousel-prev, .carousel-next {\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n    background: white;\n    border: 1px solid #cbd5e1;\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    cursor: pointer;\n    z-index: 10;\n}\n\n.carousel-prev {\n    left: 10px;\n}\n\n.carousel-next {\n    right: 10px;\n}\n\n.alert {\n    padding: 16px;\n    border-radius: 6px;\n    display: flex;\n    align-items: center;\n}\n\n.alert-info { border-left: 4px solid #3b82f6; background: #dbeafe; color: #1e3a8a; }\n.alert-success { border-left: 4px solid #10b981; background: #d1fae5; color: #065f46; }\n.alert-warning { border-left: 4px solid #f59e0b; background: #fef3c7; color: #92400e; }\n.alert-error { border-left: 4px solid #ef4444; background: #fee2e2; color: #991b1b; }\n\n.badge {\n    padding: 4px 12px;\n    border-radius: 12px;\n    font-size: 12px;\n    font-weight: bold;\n    display: inline-block;\n}\n"),C("script.js","// Script para componentes interactivos\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Manejar pesta√±as\n    const tabButtons = document.querySelectorAll('.tab-btn');\n    tabButtons.forEach(btn => {\n        btn.addEventListener('click', function() {\n            // Remover la clase activa de todos los botones\n            tabButtons.forEach(b => b.classList.remove('active'));\n            // Agregar clase activa al bot√≥n clickeado\n            this.classList.add('active');\n        });\n    });\n\n    // Manejar acorde√≥n\n    const accordionHeaders = document.querySelectorAll('.accordion-header');\n    accordionHeaders.forEach(header => {\n        header.addEventListener('click', function() {\n            const content = this.nextElementSibling;\n            if (content.style.display === 'none' || content.style.display === '') {\n                content.style.display = 'block';\n            } else {\n                content.style.display = 'none';\n            }\n        });\n    });\n\n    // Manejar modales\n    const modalTriggers = document.querySelectorAll('.modal-trigger');\n    modalTriggers.forEach(trigger => {\n        const modal = trigger.nextElementSibling;\n        const closeBtn = modal.querySelector('.modal-close');\n        const modalBtn = modal.querySelector('.modal-btn');\n\n        trigger.addEventListener('click', function(e) {\n            e.preventDefault();\n            modal.style.display = 'flex';\n        });\n\n        function closeModal() {\n            modal.style.display = 'none';\n        }\n\n        closeBtn.addEventListener('click', closeModal);\n        modalBtn.addEventListener('click', closeModal);\n\n        // Cerrar al hacer clic fuera del contenido\n        modal.addEventListener('click', function(e) {\n            if (e.target === modal) {\n                closeModal();\n            }\n        });\n    });\n\n    // Manejar carrusel\n    const carousels = document.querySelectorAll('.carousel-container');\n    carousels.forEach(carousel => {\n        const slidesContainer = carousel.querySelector('.carousel-slides');\n        const prevBtn = carousel.querySelector('.carousel-prev');\n        const nextBtn = carousel.querySelector('.carousel-next');\n        let currentSlide = 0;\n        const slides = carousel.querySelectorAll('.carousel-slides > div');\n\n        function updateCarousel() {\n            slidesContainer.style.transform = `translateX(-${currentSlide * 100}%)`;\n        }\n\n        prevBtn.addEventListener('click', function(e) {\n            e.stopPropagation();\n            if (currentSlide > 0) {\n                currentSlide--;\n                updateCarousel();\n            }\n        });\n\n        nextBtn.addEventListener('click', function(e) {\n            e.stopPropagation();\n            if (currentSlide < slides.length - 1) {\n                currentSlide++;\n                updateCarousel();\n            }\n        });\n    });\n});\n"),L("Archivos exportados: index.html, styles.css, script.js")},window.showHelp=function(){document.getElementById("helpScreen").classList.remove("hidden"),document.getElementById("galleryScreen").classList.add("hidden")},window.saveProject=T,window.importHTMLFile=function(e){const t=e.target.files[0];t&&(t.name.endsWith(".html")||t.name.endsWith(".htm")?A.parseHTMLFile(t).then(e=>{L(I.loadProjectToCanvas(e)?"Archivo HTML importado y convertido a JSON":"Error al importar el archivo HTML")}).catch(e=>{console.error("Error al importar HTML:",e),L("Error al procesar el archivo HTML")}):L("Por favor selecciona un archivo HTML v√°lido"),e.target.value="")},window.showProjectsPanel=function(){document.getElementById("projectsPanel").classList.remove("hidden"),function(){if(!s)return;const e=document.getElementById("projectsList"),t=s.getStoredProjects();0!==t.length?e.innerHTML=t.map(e=>`\n                <div class="project-card" onclick="loadProjectFromPanel('${e.id}')">\n                    <div class="project-thumbnail">\n                        ${e.thumbnail?`<img src="${e.thumbnail}" style="width: 100%; height: 100%; object-fit: cover;">`:"üìÑ"}\n                    </div>\n                    <div class="project-info">\n                        <h4 class="project-name">${e.name}</h4>\n                        <div class="project-meta">\n                            Modificado: ${new Date(e.modified).toLocaleDateString()}\n                        </div>\n                        <div class="project-actions-card">\n                            <button class="project-action-btn" onclick="event.stopPropagation(); renameProjectDialog('${e.id}')">Renombrar</button>\n                            <button class="project-action-btn" onclick="event.stopPropagation(); duplicateProjectFromPanel('${e.id}')">Duplicar</button>\n                            <button class="project-action-btn" onclick="event.stopPropagation(); exportProjectFromPanel('${e.id}')">Exportar</button>\n                            <button class="project-action-btn danger" onclick="event.stopPropagation(); deleteProjectFromPanel('${e.id}')">Eliminar</button>\n                        </div>\n                    </div>\n                </div>\n            `).join(""):e.innerHTML='<div style="text-align: center; color: #64748b; padding: 40px;">No hay proyectos guardados</div>'}()},window.showComponentsLibrary=function(){document.getElementById("componentsLibraryPanel").classList.remove("hidden"),function(){if(!l)return;const e=document.getElementById("libraryComponentsList"),t=l.getStoredComponents();0!==t.length?e.innerHTML=t.map(e=>`\n                <div class="library-component-card" onclick="addComponentFromLibrary('${e.id}')">\n                    <div class="component-preview">\n                        ${e.preview||e.type}\n                    </div>\n                    <div class="component-info">\n                        <h4 class="component-name">${e.name}</h4>\n                        <div class="component-tags">\n                            ${e.tags.map(e=>`<span class="component-tag">${e}</span>`).join("")}\n                        </div>\n                    </div>\n                </div>\n            `).join(""):e.innerHTML='<div style="text-align: center; color: #64748b; padding: 40px;">No hay componentes en la biblioteca<br><small>Importa archivos HTML para extraer componentes autom√°ticamente</small></div>'}()},window.toggleCategory=function(e){e.classList.toggle("collapsed"),e.nextElementSibling.classList.toggle("collapsed")},void 0!==t&&t.exports&&(t.exports={createComponent:y});let j=class{constructor(){this.supportedTypes={html:["text/html",".html",".htm"],css:["text/css",".css"],js:["text/javascript","application/javascript",".js"],images:["image/png","image/jpeg","image/gif","image/webp","image/svg+xml",".png",".jpg",".jpeg",".gif",".webp",".svg"]},this.setupDropZone()}setupDropZone(){const e=document.getElementById("canvas");["dragenter","dragover","dragleave","drop"].forEach(t=>{e.addEventListener(t,this.preventDefaults,!1),document.body.addEventListener(t,this.preventDefaults,!1)}),["dragenter","dragover"].forEach(t=>{e.addEventListener(t,this.highlight.bind(this),!1)}),["dragleave","drop"].forEach(t=>{e.addEventListener(t,this.unhighlight.bind(this),!1)}),e.addEventListener("drop",this.handleDrop.bind(this),!1)}preventDefaults(e){e.preventDefault(),e.stopPropagation()}highlight(e){document.getElementById("canvas").classList.add("file-drop-zone")}unhighlight(e){document.getElementById("canvas").classList.remove("file-drop-zone")}handleDrop(e){return u(this,null,function*(){const t=e.dataTransfer.files;t.length>0&&(yield this.processFiles(t))})}processFiles(e){return u(this,null,function*(){const t=Array.from(e);for(const e of t)yield this.processFile(e)})}processFile(e){return u(this,null,function*(){const t=this.getFileType(e);try{switch(t){case"html":yield this.loadHTMLFile(e);break;case"css":yield this.loadCSSFile(e);break;case"js":yield this.loadJSFile(e);break;case"images":yield this.loadImageFile(e);break;default:this.showError(`Tipo de archivo no soportado: ${e.name}`)}}catch(n){this.showError(`Error al cargar ${e.name}: ${n.message}`)}})}getFileType(e){const t=e.name.toLowerCase(),n=e.type.toLowerCase();for(const[o,i]of Object.entries(this.supportedTypes))if(i.some(e=>e.startsWith(".")?t.endsWith(e):n===e))return o;return null}loadHTMLFile(e){return u(this,null,function*(){const t=yield this.readFileAsText(e);if(yield this.showHTMLPreview(t,e.name)){const n=new HTMLParser;if(yield n.parseAndLoad(t),window.componentExtractor)if(window.componentExtractor.extractComponents(t).length>0){const t=window.componentExtractor.saveExtractedComponents();this.showSuccess(`Archivo HTML "${e.name}" cargado correctamente. ${t} componentes extra√≠dos.`)}else this.showSuccess(`Archivo HTML "${e.name}" cargado correctamente`);else this.showSuccess(`Archivo HTML "${e.name}" cargado correctamente`)}})}loadCSSFile(e){return u(this,null,function*(){const t=yield this.readFileAsText(e),n=document.createElement("style");n.textContent=t,n.setAttribute("data-source",e.name),document.head.appendChild(n),this.showSuccess(`Estilos CSS de "${e.name}" aplicados`)})}loadJSFile(e){return u(this,null,function*(){const t=yield this.readFileAsText(e);if(confirm(`¬øDeseas ejecutar el c√≥digo JavaScript de "${e.name}"?\n\nADVERTENCIA: Solo ejecuta c√≥digo de fuentes confiables.`))try{const n=document.createElement("script");n.textContent=t,n.setAttribute("data-source",e.name),document.head.appendChild(n),this.showSuccess(`JavaScript de "${e.name}" ejecutado`)}catch(n){this.showError(`Error al ejecutar JavaScript: ${n.message}`)}})}loadImageFile(e){return u(this,null,function*(){const t=yield this.readFileAsDataURL(e),n=document.createElement("img");n.src=t,n.alt=e.name,n.style.maxWidth="100%",n.style.height="auto",n.id="element-"+window.elementIdCounter++,n.classList.add("canvas-element"),n.setAttribute("data-component-type","img");const o=document.createElement("div");o.className="delete-btn",o.textContent="√ó",o.onclick=function(e){e.stopPropagation(),window.deleteElement(n)},n.appendChild(o),n.addEventListener("click",function(e){e.stopPropagation(),window.selectElement(n)}),n.addEventListener("dblclick",function(e){e.stopPropagation(),window.makeElementEditable(n)}),document.getElementById("canvas").appendChild(n),this.showSuccess(`Imagen "${e.name}" agregada al canvas`)})}showHTMLPreview(e,t){return u(this,null,function*(){return new Promise(n=>{const o=this.createPreviewModal(e,t);document.body.appendChild(o);const i=o.querySelector(".load-btn"),r=o.querySelector(".cancel-btn");i.onclick=()=>{o.remove(),n(!0)},r.onclick=()=>{o.remove(),n(!1)}})})}createPreviewModal(e,t){const n=document.createElement("div");return n.className="file-preview-modal",n.innerHTML=`\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>Vista previa: ${t}</h3>\n                    <button class="modal-close cancel-btn">&times;</button>\n                </div>\n                <div class="modal-body">\n                    <div class="preview-content">\n                        <iframe srcdoc="${this.escapeHtml(e)}" style="width: 100%; height: 400px; border: 1px solid #e2e8f0;"></iframe>\n                    </div>\n                    <div class="preview-actions">\n                        <button class="load-btn">Cargar archivo</button>\n                        <button class="cancel-btn">Cancelar</button>\n                    </div>\n                </div>\n            </div>\n        `,n}readFileAsText(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>t(e.target.result),o.onerror=e=>n(new Error("Error al leer archivo")),o.readAsText(e)})}readFileAsDataURL(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>t(e.target.result),o.onerror=e=>n(new Error("Error al leer archivo")),o.readAsDataURL(e)})}escapeHtml(e){return e.replace(/"/g,"&quot;")}showSuccess(e){window.showToast?window.showToast(e):console.log("SUCCESS:",e)}showError(e){window.showToast?window.showToast(e):console.error("ERROR:",e),alert(e)}};void 0!==t&&t.exports&&(t.exports=j),window.FileLoader=j;let z=class{constructor(){this.componentTypes={nav:"navbar",header:"header",footer:"footer",section:"seccion",article:"article",div:"contenedor",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:"p",span:"span",img:"img",video:"video",iframe:"iframe",button:"button",input:"input",textarea:"textarea",select:"select",ul:"ul",ol:"ol",li:"li",a:"link",form:"form"},this.skipElements=["script","style","meta","link","title","head"],this.elementIdCounter=window.elementIdCounter||0}parseAndLoad(e){return u(this,null,function*(){try{const t=(new DOMParser).parseFromString(e,"text/html");yield this.extractStyles(t),yield this.extractScripts(t);const n=t.body;if(n){const e=document.getElementById("canvas");if(e.children.length>0){if(!confirm("¬øDeseas reemplazar el contenido actual del canvas?"))return;e.innerHTML=""}yield this.processElements(n.children,e),window.elementIdCounter=this.elementIdCounter,this.showSuccess("HTML convertido exitosamente a componentes editables")}}catch(t){this.showError(`Error al parsear HTML: ${t.message}`)}})}extractStyles(e){return u(this,null,function*(){e.querySelectorAll("style").forEach((e,t)=>{const n=document.createElement("style");n.textContent=e.textContent,n.setAttribute("data-source",`imported-style-${t}`),document.head.appendChild(n)}),e.querySelectorAll('link[rel="stylesheet"]').forEach((e,t)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e.href,n.setAttribute("data-source",`imported-link-${t}`),document.head.appendChild(n)})})}extractScripts(e){return u(this,null,function*(){const t=e.querySelectorAll("script"),n=[];t.forEach(e=>{e.src?n.push({type:"external",src:e.src,content:null}):e.textContent.trim()&&n.push({type:"inline",src:null,content:e.textContent})}),n.length>0&&confirm(`Se encontraron ${n.length} script(s) JavaScript.\n¬øDeseas incluirlos? (Solo acepta si conf√≠as en el c√≥digo)`)&&n.forEach((e,t)=>{const n=document.createElement("script");"external"===e.type?n.src=e.src:n.textContent=e.content,n.setAttribute("data-source",`imported-script-${t}`),document.head.appendChild(n)})})}processElements(e,t){return u(this,null,function*(){for(const n of e){if(this.shouldSkipElement(n))continue;const e=yield this.convertElement(n);e&&t.appendChild(e)}})}shouldSkipElement(e){const t=e.tagName.toLowerCase();return this.skipElements.includes(t)||e.nodeType!==Node.ELEMENT_NODE}convertElement(e){return u(this,null,function*(){const t=e.tagName.toLowerCase(),n=this.componentTypes[t]||"contenedor",o=document.createElement(t);return Array.from(e.attributes).forEach(e=>{"id"!==e.name&&o.setAttribute(e.name,e.value)}),o.id="element-"+this.elementIdCounter++,o.classList.add("canvas-element"),o.setAttribute("data-component-type",n),e.style.cssText&&(o.style.cssText=e.style.cssText),yield this.processElementContent(e,o),this.addEditorFunctionality(o),o})}processElementContent(e,t){return u(this,null,function*(){if(0===e.children.length)t.textContent=e.textContent;else{yield this.processElements(e.children,t);const n=Array.from(e.childNodes).filter(e=>e.nodeType===Node.TEXT_NODE&&e.textContent.trim());n.length>0&&n.forEach(e=>{t.appendChild(document.createTextNode(e.textContent))})}})}addEditorFunctionality(e){const t=document.createElement("div");t.className="delete-btn",t.textContent="√ó",t.onclick=t=>{t.stopPropagation(),window.deleteElement?window.deleteElement(e):e.remove()},e.appendChild(t),e.addEventListener("click",t=>{t.stopPropagation(),window.selectElement&&window.selectElement(e)}),e.addEventListener("dblclick",t=>{t.stopPropagation(),window.makeElementEditable&&window.makeElementEditable(e)})}detectSpecialComponents(e){const t=e.className.toLowerCase(),n=e.tagName.toLowerCase();return"nav"===n||t.includes("nav")||t.includes("navbar")?this.convertToNavbar(e):t.includes("hero")||t.includes("banner")||t.includes("jumbotron")?this.convertToHero(e):t.includes("card")||t.includes("box")||t.includes("panel")?this.convertToCard(e):"footer"===n||t.includes("footer")?this.convertToFooter(e):null}convertToNavbar(e){return e.setAttribute("data-component-type","navbar"),e.classList.add("component-navbar"),e}convertToHero(e){return e.setAttribute("data-component-type","hero"),e.classList.add("component-hero"),e}convertToCard(e){return e.setAttribute("data-component-type","card"),e.classList.add("component-card"),e}convertToFooter(e){return e.setAttribute("data-component-type","footer"),e.classList.add("component-footer"),e}showSuccess(e){window.showToast?window.showToast(e):console.log("SUCCESS:",e)}showError(e){window.showToast?window.showToast(e):console.error("ERROR:",e),alert(e)}};void 0!==t&&t.exports&&(t.exports=z),window.HTMLParser=z;let M=class{constructor(){this.storageKey="dragndrop_projects",this.currentProjectKey="dragndrop_current_project",this.autoSaveInterval=3e4,this.autoSaveTimer=null,this.currentProject=null,this.init()}init(){this.loadCurrentProject(),this.startAutoSave(),this.setupEventListeners()}createNewProject(e=null){const t=e||`Proyecto ${(new Date).toLocaleDateString()}`;return this.currentProject={id:this.generateId(),name:t,created:(new Date).toISOString(),modified:(new Date).toISOString(),html:"",version:1,thumbnail:null},this.saveCurrentProject(),this.showSuccess(`Nuevo proyecto "${t}" creado`),this.currentProject}saveCurrentProject(){this.currentProject||this.createNewProject();const e=document.getElementById("canvas");e&&(this.currentProject.html=e.innerHTML,this.currentProject.modified=(new Date).toISOString(),this.generateThumbnail().then(e=>{this.currentProject.thumbnail=e,this.saveToStorage()})),localStorage.setItem(this.currentProjectKey,JSON.stringify(this.currentProject))}saveToStorage(){const e=this.getStoredProjects(),t=e.findIndex(e=>e.id===this.currentProject.id);t>=0?e[t]=d({},this.currentProject):e.unshift(this.currentProject),e.length>20&&e.splice(20),localStorage.setItem(this.storageKey,JSON.stringify(e))}loadCurrentProject(){try{const e=localStorage.getItem(this.currentProjectKey);e&&(this.currentProject=JSON.parse(e),this.loadProjectToCanvas(this.currentProject),this.showSuccess(`Proyecto "${this.currentProject.name}" restaurado`))}catch(e){console.error("Error al cargar proyecto actual:",e)}}loadProject(e){const t=this.getStoredProjects().find(t=>t.id===e);return t?(this.currentProject=d({},t),this.loadProjectToCanvas(t),this.saveCurrentProject(),this.showSuccess(`Proyecto "${t.name}" cargado`),!0):(this.showError("Proyecto no encontrado"),!1)}loadProjectToCanvas(e){const t=document.getElementById("canvas");t&&e.html&&(t.innerHTML=e.html,this.reapplyEditorEvents())}reapplyEditorEvents(){document.querySelectorAll(".canvas-element").forEach(e=>{e.replaceWith(e.cloneNode(!0));const t=document.querySelector(`#${e.id}`);t.addEventListener("click",function(e){e.stopPropagation(),window.selectElement&&window.selectElement(t)}),t.addEventListener("dblclick",function(e){e.stopPropagation(),window.makeElementEditable&&window.makeElementEditable(t)});const n=t.querySelector(".delete-btn");n&&(n.onclick=function(e){e.stopPropagation(),window.deleteElement&&window.deleteElement(t)})})}getStoredProjects(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return console.error("Error al obtener proyectos:",e),[]}}deleteProject(e){const t=this.getStoredProjects().filter(t=>t.id!==e);localStorage.setItem(this.storageKey,JSON.stringify(t)),this.currentProject&&this.currentProject.id===e&&this.createNewProject(),this.showSuccess("Proyecto eliminado")}duplicateProject(e){const t=this.getStoredProjects(),n=t.find(t=>t.id===e);if(n){const e=p(d({},n),{id:this.generateId(),name:`${n.name} (Copia)`,created:(new Date).toISOString(),modified:(new Date).toISOString()});return t.unshift(e),localStorage.setItem(this.storageKey,JSON.stringify(t)),this.showSuccess(`Proyecto duplicado: "${e.name}"`),e}return null}renameProject(e,t){const n=this.getStoredProjects(),o=n.find(t=>t.id===e);return!!o&&(o.name=t,o.modified=(new Date).toISOString(),localStorage.setItem(this.storageKey,JSON.stringify(n)),this.currentProject&&this.currentProject.id===e&&(this.currentProject.name=t,this.saveCurrentProject()),this.showSuccess(`Proyecto renombrado a "${t}"`),!0)}exportProject(e=null){const t=e?this.getStoredProjects().find(t=>t.id===e):this.currentProject;if(t){const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download=`${t.name}.json`,o.click(),URL.revokeObjectURL(n),this.showSuccess(`Proyecto "${t.name}" exportado`)}}importProject(e){return u(this,null,function*(){try{const t=yield this.readFileAsText(e),n=JSON.parse(t);if(!n.id||!n.name||!n.html)throw new Error("Formato de proyecto inv√°lido");n.id=this.generateId(),n.name=`${n.name} (Importado)`,n.modified=(new Date).toISOString();const o=this.getStoredProjects();return o.unshift(n),localStorage.setItem(this.storageKey,JSON.stringify(o)),this.showSuccess(`Proyecto "${n.name}" importado`),n}catch(t){return this.showError(`Error al importar proyecto: ${t.message}`),null}})}startAutoSave(){this.stopAutoSave(),this.autoSaveTimer=setInterval(()=>{this.currentProject&&(this.saveCurrentProject(),console.log("Auto-guardado realizado"))},this.autoSaveInterval)}stopAutoSave(){this.autoSaveTimer&&(clearInterval(this.autoSaveTimer),this.autoSaveTimer=null)}setupEventListeners(){window.addEventListener("beforeunload",()=>{this.saveCurrentProject()});const e=document.getElementById("canvas");e&&new MutationObserver(()=>{this.currentProject&&(this.currentProject.modified=(new Date).toISOString())}).observe(e,{childList:!0,subtree:!0,attributes:!0,characterData:!0})}generateThumbnail(){return u(this,null,function*(){try{const e=document.getElementById("canvas");return e&&"undefined"!=typeof html2canvas?(yield html2canvas(e,{width:300,height:200,scale:.3})).toDataURL("image/jpeg",.7):null}catch(e){return console.error("Error generando thumbnail:",e),null}})}generateId(){return"project_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}readFileAsText(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>t(e.target.result),o.onerror=e=>n(new Error("Error al leer archivo")),o.readAsText(e)})}getCurrentProjectInfo(){return this.currentProject?d({},this.currentProject):null}getProjectStats(){const e=this.getStoredProjects();return{total:e.length,current:this.currentProject?this.currentProject.name:"Sin proyecto",lastModified:e.length>0?e[0].modified:null}}showSuccess(e){window.showToast?window.showToast(e):console.log("SUCCESS:",e)}showError(e){window.showToast?window.showToast(e):console.error("ERROR:",e)}};void 0!==t&&t.exports&&(t.exports=M),window.ProjectManager=M;let $=class{constructor(){this.extractedComponents=[],this.componentPatterns={navbar:{selectors:["nav",".navbar",".nav",".navigation",".header-nav"],minElements:2,requiredElements:["a","ul","li"]},card:{selectors:[".card",".box",".panel",".item",".product"],minElements:2,requiredElements:["h1","h2","h3","h4","h5","h6","p","img"]},hero:{selectors:[".hero",".banner",".jumbotron",".intro",".header-section"],minElements:2,requiredElements:["h1","h2","p","button","a"]},footer:{selectors:["footer",".footer",".site-footer"],minElements:1,requiredElements:["p","a","ul"]},form:{selectors:["form",".form",".contact-form"],minElements:2,requiredElements:["input","textarea","button","select"]},gallery:{selectors:[".gallery",".grid",".portfolio",".images"],minElements:3,requiredElements:["img"]},testimonial:{selectors:[".testimonial",".review",".quote"],minElements:2,requiredElements:["p","blockquote"]},pricing:{selectors:[".pricing",".price",".plan"],minElements:2,requiredElements:["h1","h2","h3","h4","span","button"]}}}extractComponents(e){const t=(new DOMParser).parseFromString(e,"text/html");this.extractedComponents=[];for(const[n,o]of Object.entries(this.componentPatterns))this.findComponentsByPattern(t,n,o);return this.findComponentsByStructure(t),this.extractedComponents}findComponentsByPattern(e,t,n){n.selectors.forEach(o=>{e.querySelectorAll(o).forEach(e=>{if(this.validateComponent(e,n)){const n=this.createComponent(e,t);n&&this.extractedComponents.push(n)}})})}findComponentsByStructure(e){e.querySelectorAll("div, section, article").forEach(e=>{if(this.couldBeComponent(e)){const t=this.guessComponentType(e),n=this.createComponent(e,t);n&&this.extractedComponents.push(n)}})}validateComponent(e,t){return!(e.querySelectorAll("*").length<t.minElements)&&t.requiredElements.some(t=>null!==e.querySelector(t))}couldBeComponent(e){const t=e.children,n=e.textContent.trim();return!(t.length<2&&n.length<50)&&(!(t.length>20)&&new Set(Array.from(t).map(e=>e.tagName)).size>=2)}guessComponentType(e){const t=e.className.toLowerCase(),n=e.textContent.toLowerCase();if(t.includes("nav"))return"navbar";if(t.includes("card")||t.includes("box"))return"card";if(t.includes("hero")||t.includes("banner"))return"hero";if(t.includes("footer"))return"footer";if(t.includes("form"))return"form";if(t.includes("gallery")||t.includes("grid"))return"gallery";if(e.querySelector("form"))return"form";if(e.querySelectorAll("img").length>=3)return"gallery";if(e.querySelector("blockquote"))return"testimonial";if(n.includes("$")||n.includes("precio"))return"pricing";const o=e.querySelector("h1, h2, h3, h4, h5, h6"),i=e.querySelector("img"),r=e.querySelector('button, .btn, a[class*="btn"]');return o&&i&&r?"card":o&&r&&e.children.length<=5?"hero":"custom"}createComponent(e,t){try{const n=this.cleanElement(e.cloneNode(!0));return{id:this.generateComponentId(),type:t,name:this.generateComponentName(n,t),html:n.outerHTML,css:this.extractElementCSS(e),preview:this.generatePreview(n),tags:this.generateTags(n,t),created:(new Date).toISOString()}}catch(n){return console.error("Error creando componente:",n),null}}cleanElement(e){e.querySelectorAll("script").forEach(e=>e.remove());const t=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,null,!1),n=[];let o;for(;o=t.nextNode();)n.push(o);return n.forEach(e=>e.remove()),e.querySelectorAll("*").forEach(e=>{e.removeAttribute("onclick"),e.removeAttribute("onload"),e.removeAttribute("onerror")}),e}extractElementCSS(e){const t=[];return e.style.cssText&&t.push(`/* Estilos inline */\n.${e.className||"component"} {\n  ${e.style.cssText}\n}`),e.querySelectorAll("[style]").forEach((e,n)=>{if(e.style.cssText){const o=e.className?`.${e.className}`:`element-${n}`;t.push(`${o} {\n  ${e.style.cssText}\n}`)}}),t.join("\n\n")}generatePreview(e){const t=e.cloneNode(!0);return t.querySelectorAll("p, span, h1, h2, h3, h4, h5, h6").forEach(e=>{e.textContent.length>50&&(e.textContent=e.textContent.substring(0,50)+"...")}),t.outerHTML}generateTags(e,t){const n=[t];e.querySelector("img")&&n.push("imagen"),e.querySelector("button, .btn")&&n.push("bot√≥n"),e.querySelector("form")&&n.push("formulario"),e.querySelector("ul, ol")&&n.push("lista"),e.querySelector("table")&&n.push("tabla");const o=e.className.toLowerCase();return o.includes("responsive")&&n.push("responsive"),o.includes("dark")&&n.push("oscuro"),o.includes("light")&&n.push("claro"),[...new Set(n)]}generateComponentName(e,t){const n=e.querySelector("h1, h2, h3, h4, h5, h6");if(n&&n.textContent.trim()){const e=n.textContent.trim().substring(0,30);return`${this.capitalizeFirst(t)} - ${e}`}if(e.className){const n=e.className.split(" ")[0];return`${this.capitalizeFirst(t)} - ${n}`}const o=(new Date).toLocaleTimeString();return`${this.capitalizeFirst(t)} ${o}`}generateComponentId(){return"comp_"+Date.now()+"_"+Math.random().toString(36).substr(2,6)}capitalizeFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}saveExtractedComponents(){const e=[...this.getStoredComponents(),...this.extractedComponents];return e.length>50&&e.splice(50),localStorage.setItem("dragndrop_extracted_components",JSON.stringify(e)),this.extractedComponents.length}getStoredComponents(){try{const e="dragndrop_extracted_components",t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch(e){return console.error("Error al obtener componentes:",e),[]}}deleteStoredComponent(e){const t=this.getStoredComponents().filter(t=>t.id!==e);localStorage.setItem("dragndrop_extracted_components",JSON.stringify(t))}searchComponents(e){const t=this.getStoredComponents(),n=e.toLowerCase();return t.filter(e=>e.name.toLowerCase().includes(n)||e.type.toLowerCase().includes(n)||e.tags.some(e=>e.toLowerCase().includes(n)))}};void 0!==t&&t.exports&&(t.exports=$),window.ComponentExtractor=$;class D{constructor(){this.history=[],this.currentIndex=-1,this.maxHistorySize=50,this.isProcessing=!1}init(){this.saveInitialState(),this.setupEventListeners()}saveInitialState(){document.getElementById("canvas")&&this.saveState({type:"initial",description:"Estado inicial"})}saveState(e={}){if(this.isProcessing)return;const t=document.getElementById("canvas");if(!t)return;const n={html:t.innerHTML,timestamp:Date.now(),action:{type:e.type||"unknown",description:e.description||"Cambio",elementId:e.elementId||null}};this.currentIndex<this.history.length-1&&this.history.splice(this.currentIndex+1),this.history.push(n),this.currentIndex++,this.history.length>this.maxHistorySize&&(this.history.shift(),this.currentIndex--),this.updateUI()}undo(){return this.canUndo()?(this.currentIndex--,this.restoreState(this.history[this.currentIndex]),this.updateUI(),this.showMessage("Deshecho"),!0):(this.showMessage("No hay cambios para deshacer"),!1)}redo(){return this.canRedo()?(this.currentIndex++,this.restoreState(this.history[this.currentIndex]),this.updateUI(),this.showMessage("Rehecho"),!0):(this.showMessage("No hay cambios para rehacer"),!1)}canUndo(){return this.currentIndex>0}canRedo(){return this.currentIndex<this.history.length-1}restoreState(e){this.isProcessing=!0;const t=document.getElementById("canvas");t&&e&&(t.innerHTML=e.html,window.projectManager&&window.projectManager.reapplyEditorEvents()),this.isProcessing=!1}setupEventListeners(){document.addEventListener("keydown",e=>{!e.ctrlKey&&!e.metaKey||"z"!==e.key||e.shiftKey||(e.preventDefault(),this.undo()),(e.ctrlKey||e.metaKey)&&"z"===e.key&&e.shiftKey&&(e.preventDefault(),this.redo()),(e.ctrlKey||e.metaKey)&&"y"===e.key&&(e.preventDefault(),this.redo())});const e=document.getElementById("canvas");e&&new MutationObserver(e=>{!this.isProcessing&&e.length>0&&(clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(()=>{this.saveState({type:"edit",description:"Edici√≥n de contenido"})},500))}).observe(e,{childList:!0,subtree:!0,attributes:!0,characterData:!0})}updateUI(){var e,t;const n=document.getElementById("undoBtn"),o=document.getElementById("redoBtn");n&&(n.disabled=!this.canUndo(),n.title=this.canUndo()?`Deshacer: ${(null==(e=this.history[this.currentIndex-1])?void 0:e.action.description)||""}`:"No hay cambios para deshacer"),o&&(o.disabled=!this.canRedo(),o.title=this.canRedo()?`Rehacer: ${(null==(t=this.history[this.currentIndex+1])?void 0:t.action.description)||""}`:"No hay cambios para rehacer")}getHistory(){return this.history.map((e,t)=>({index:t,isCurrent:t===this.currentIndex,description:e.action.description,timestamp:new Date(e.timestamp).toLocaleString()}))}jumpToState(e){return e>=0&&e<this.history.length&&(this.currentIndex=e,this.restoreState(this.history[this.currentIndex]),this.updateUI(),!0)}clearHistory(){this.history=[],this.currentIndex=-1,this.saveInitialState()}showMessage(e){window.showToast?window.showToast(e):console.log(e)}}void 0!==t&&t.exports&&(t.exports=D),window.UndoRedoManager=D;class B{constructor(){this.shortcuts=new Map,this.init()}init(){this.registerDefaultShortcuts(),this.setupEventListener()}registerDefaultShortcuts(){this.register("ctrl+s","Guardar proyecto",()=>{window.projectManager&&window.projectManager.saveCurrentProject()}),this.register("ctrl+shift+s","Guardar como...",()=>{window.showProjectsPanel&&window.showProjectsPanel()}),this.register("ctrl+o","Abrir proyecto",()=>{window.showProjectsPanel&&window.showProjectsPanel()}),this.register("ctrl+n","Nuevo proyecto",()=>{window.newProject&&window.newProject()}),this.register("ctrl+z","Deshacer",()=>{window.undoRedoManager&&window.undoRedoManager.undo()}),this.register("ctrl+shift+z","Rehacer",()=>{window.undoRedoManager&&window.undoRedoManager.redo()}),this.register("ctrl+y","Rehacer (alt)",()=>{window.undoRedoManager&&window.undoRedoManager.redo()}),this.register("delete","Eliminar elemento",()=>{window.selectedElement&&window.deleteElement&&window.deleteElement(window.selectedElement)}),this.register("backspace","Eliminar elemento (alt)",()=>{const e=event.target;"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&!e.isContentEditable&&window.selectedElement&&window.deleteElement&&(event.preventDefault(),window.deleteElement(window.selectedElement))}),this.register("escape","Deseleccionar",()=>{if(window.selectedElement){window.selectedElement.classList.remove("selected"),window.selectedElement=null;const e=document.getElementById("propertiesPanel");e&&(e.innerHTML='\n                        <h2 class="panel-title">Propiedades</h2>\n                        <div class="properties-empty">\n                            ‚Üê Arrastra componentes al canvas o selecciona un elemento para editar sus propiedades\n                        </div>\n                    ')}}),this.register("ctrl+d","Duplicar elemento",()=>{if(window.selectedElement){const e=window.selectedElement.cloneNode(!0);e.id="element-"+window.elementIdCounter++,window.setupElementDragAndDrop&&window.setupElementDragAndDrop(e),window.selectedElement.parentNode.insertBefore(e,window.selectedElement.nextSibling),window.showToast&&window.showToast("Elemento duplicado")}}),this.register("ctrl+shift+p","Panel de comandos",()=>{this.showCommandPalette()}),this.register("ctrl+/","Ayuda r√°pida",()=>{this.showQuickHelp()}),this.register("ctrl+1","Vista escritorio",()=>{window.setCanvasSize&&window.setCanvasSize("desktop")}),this.register("ctrl+2","Vista tablet",()=>{window.setCanvasSize&&window.setCanvasSize("tablet")}),this.register("ctrl+3","Vista m√≥vil",()=>{window.setCanvasSize&&window.setCanvasSize("mobile")}),this.register("ctrl+e","Exportar HTML",()=>{window.exportHTML&&window.exportHTML()}),this.register("ctrl+shift+e","Exportar todo",()=>{window.exportZip&&window.exportZip()}),this.register("ctrl+t","Plantillas",()=>{window.showGallery&&window.showGallery()}),this.register("ctrl+shift+c","Componentes",()=>{window.showComponentsLibrary&&window.showComponentsLibrary()})}register(e,t,n){const o=this.normalizeShortcut(e);this.shortcuts.set(o,{description:t,callback:n,originalShortcut:e})}normalizeShortcut(e){return e.toLowerCase().replace("command","ctrl").replace("cmd","ctrl").split("+").sort().join("+")}eventToShortcut(e){const t=[];(e.ctrlKey||e.metaKey)&&t.push("ctrl"),e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt");const n=e.key.toLowerCase();return["control","shift","alt","meta"].includes(n)||t.push(n),t.sort().join("+")}setupEventListener(){document.addEventListener("keydown",e=>{const t=this.eventToShortcut(e),n=this.shortcuts.get(t);if(n){const o=e.target;if(("INPUT"===o.tagName||"TEXTAREA"===o.tagName||o.isContentEditable)&&!["ctrl+s","ctrl+z","ctrl+y","ctrl+shift+z"].includes(t))return;e.preventDefault(),n.callback(e)}})}showCommandPalette(){const e=document.createElement("div");e.className="command-palette-modal",e.innerHTML=`\n            <div class="command-palette-content">\n                <div class="command-palette-header">\n                    <input type="text" id="commandSearch" placeholder="Buscar comando o atajo..." autofocus>\n                    <button onclick="this.closest('.command-palette-modal').remove()">&times;</button>\n                </div>\n                <div class="command-palette-list" id="commandPaletteList">\n                    ${this.renderCommandList()}\n                </div>\n            </div>\n        `,document.body.appendChild(e),e.addEventListener("keydown",t=>{"Escape"===t.key&&e.remove()});const t=e.querySelector("#commandSearch");t.addEventListener("input",()=>{const n=t.value.toLowerCase();e.querySelector("#commandPaletteList").innerHTML=this.renderCommandList(n)}),t.focus()}renderCommandList(e=""){const t=Array.from(this.shortcuts.entries()).filter(([t,n])=>!e||t.includes(e)||n.description.toLowerCase().includes(e)).map(([e,t])=>`\n                <div class="command-item" onclick="event.stopPropagation(); this.closest('.command-palette-modal').querySelector('button').click(); ${t.callback.toString().match(/\{([\s\S]*)\}/)[1]}">\n                    <span class="command-description">${t.description}</span>\n                    <span class="command-shortcut">${t.originalShortcut.toUpperCase()}</span>\n                </div>\n            `);return t.length>0?t.join(""):'<div class="command-empty">No se encontraron comandos</div>'}showQuickHelp(){const e=Array.from(this.shortcuts.entries()).map(([e,t])=>`\n                <tr>\n                    <td><kbd>${t.originalShortcut.toUpperCase()}</kbd></td>\n                    <td>${t.description}</td>\n                </tr>\n            `).join(""),t=document.createElement("div");t.className="quick-help-modal",t.innerHTML=`\n            <div class="quick-help-content">\n                <div class="quick-help-header">\n                    <h3>Atajos de Teclado</h3>\n                    <button onclick="this.closest('.quick-help-modal').remove()">&times;</button>\n                </div>\n                <div class="quick-help-body">\n                    <table class="shortcuts-table">\n                        <thead>\n                            <tr>\n                                <th>Atajo</th>\n                                <th>Descripci√≥n</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            ${e}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        `,document.body.appendChild(t),t.addEventListener("click",e=>{e.target===t&&t.remove()}),t.addEventListener("keydown",e=>{"Escape"===e.key&&t.remove()})}getAllShortcuts(){return Array.from(this.shortcuts.entries()).map(([e,t])=>({shortcut:t.originalShortcut,description:t.description}))}unregister(e){const t=this.normalizeShortcut(e);return this.shortcuts.delete(t)}}void 0!==t&&t.exports&&(t.exports=B),window.KeyboardShortcutsManager=B;class H{constructor(){this.devices={"mobile-small":{name:"Mobile S",width:320,height:568,icon:"üì±"},mobile:{name:"Mobile",width:375,height:667,icon:"üì±"},"mobile-large":{name:"Mobile L",width:425,height:812,icon:"üì±"},tablet:{name:"Tablet",width:768,height:1024,icon:"üì±"},laptop:{name:"Laptop",width:1024,height:768,icon:"üíª"},"laptop-large":{name:"Laptop L",width:1440,height:900,icon:"üíª"},desktop:{name:"Desktop",width:1920,height:1080,icon:"üñ•Ô∏è"},"4k":{name:"4K",width:2560,height:1440,icon:"üñ•Ô∏è"}},this.customSizes=this.loadCustomSizes(),this.currentDevice="desktop",this.orientation="portrait"}init(){this.createTestPanel(),this.setupEventListeners()}createTestPanel(){if(document.getElementById("responsiveTesterPanel"))return;const e=document.createElement("div");e.id="responsiveTesterPanel",e.className="responsive-tester-panel hidden",e.innerHTML=`\n            <div class="panel-overlay" onclick="closeResponsiveTester()"></div>\n            <div class="panel-content">\n                <div class="panel-header">\n                    <h2>üîç Responsive Tester</h2>\n                    <button class="close-panel-btn" onclick="closeResponsiveTester()">&times;</button>\n                </div>\n                <div class="panel-body">\n                    <div class="device-selector">\n                        <h3>Dispositivos Predefinidos</h3>\n                        <div class="device-grid" id="deviceGrid">\n                            ${this.renderDeviceButtons()}\n                        </div>\n                    </div>\n                    \n                    <div class="custom-size-section">\n                        <h3>Tama√±o Personalizado</h3>\n                        <div class="custom-size-inputs">\n                            <div class="input-group">\n                                <label>Ancho (px)</label>\n                                <input type="number" id="customWidth" value="1024" min="320" max="3840">\n                            </div>\n                            <div class="input-group">\n                                <label>Alto (px)</label>\n                                <input type="number" id="customHeight" value="768" min="320" max="2160">\n                            </div>\n                            <button class="btn primary" onclick="applyCustomSize()">Aplicar</button>\n                        </div>\n                    </div>\n                    \n                    <div class="orientation-section">\n                        <h3>Orientaci√≥n</h3>\n                        <div class="orientation-buttons">\n                            <button class="btn" id="portraitBtn" onclick="setOrientation('portrait')">üì± Portrait</button>\n                            <button class="btn" id="landscapeBtn" onclick="setOrientation('landscape')">üì± Landscape</button>\n                        </div>\n                    </div>\n                    \n                    <div class="test-info">\n                        <div class="current-size" id="currentSizeInfo">\n                            <strong>Tama√±o actual:</strong> <span id="currentSizeDisplay">1920 x 1080</span>\n                        </div>\n                        <div class="breakpoint-info" id="breakpointInfo">\n                            <strong>Breakpoint:</strong> <span id="breakpointDisplay">Desktop</span>\n                        </div>\n                    </div>\n                    \n                    <div class="test-actions">\n                        <button class="btn" onclick="takeScreenshot()">üì∏ Capturar Pantalla</button>\n                        <button class="btn" onclick="testAllSizes()">üéØ Probar Todos los Tama√±os</button>\n                        <button class="btn" onclick="resetCanvas()">‚Ü∫ Restablecer</button>\n                    </div>\n                </div>\n            </div>\n        `,document.body.appendChild(e)}renderDeviceButtons(){return Object.entries(this.devices).map(([e,t])=>`\n            <button class="device-btn" onclick="setDeviceSize('${e}')">\n                <span class="device-icon">${t.icon}</span>\n                <span class="device-name">${t.name}</span>\n                <span class="device-size">${t.width} √ó ${t.height}</span>\n            </button>\n        `).join("")}setSize(e,t){const n=document.getElementById("canvasWrapper");n&&(n.style.width=e+"px",n.style.height=t+"px",n.style.transition="all 0.3s ease",this.updateSizeDisplay(e,t),this.updateBreakpointDisplay(e))}setDeviceSize(e){const t=this.devices[e];if(!t)return;this.currentDevice=e;let n=t.width,o=t.height;"landscape"===this.orientation&&([n,o]=[o,n]),this.setSize(n,o),window.showToast&&window.showToast(`Vista ${t.name} aplicada`)}setOrientation(e){this.orientation=e;const t=document.getElementById("portraitBtn"),n=document.getElementById("landscapeBtn");t&&n&&(t.classList.toggle("active","portrait"===e),n.classList.toggle("active","landscape"===e)),this.currentDevice&&this.setDeviceSize(this.currentDevice)}applyCustomSize(){const e=document.getElementById("customWidth"),t=document.getElementById("customHeight");if(e&&t){const n=parseInt(e.value),o=parseInt(t.value);n&&o&&n>=320&&o>=320&&(this.setSize(n,o),window.showToast&&window.showToast(`Tama√±o personalizado ${n}√ó${o} aplicado`))}}updateSizeDisplay(e,t){const n=document.getElementById("currentSizeDisplay");n&&(n.textContent=`${e} √ó ${t}`)}updateBreakpointDisplay(e){const t=document.getElementById("breakpointDisplay");if(!t)return;let n="";n=e<576?"Extra Small (< 576px)":e<768?"Small (576px - 768px)":e<992?"Medium (768px - 992px)":e<1200?"Large (992px - 1200px)":e<1400?"Extra Large (1200px - 1400px)":"XXL (> 1400px)",t.textContent=n}takeScreenshot(){return u(this,null,function*(){const e=document.getElementById("canvas");if(e)try{if("undefined"!=typeof html2canvas){const t=(yield html2canvas(e)).toDataURL("image/png"),n=document.createElement("a");n.href=t,n.download=`screenshot-${Date.now()}.png`,n.click(),window.showToast&&window.showToast("Captura guardada")}else window.showToast&&window.showToast("html2canvas no est√° disponible","error")}catch(t){console.error("Error capturando pantalla:",t),window.showToast&&window.showToast("Error al capturar pantalla","error")}})}testAllSizes(){return u(this,null,function*(){const e=Object.keys(this.devices);let t=0;const n=()=>{t>=e.length?window.showToast&&window.showToast("Prueba de todos los tama√±os completada"):(this.setDeviceSize(e[t]),t++,setTimeout(n,1500))};n()})}resetCanvas(){this.setDeviceSize("desktop"),this.setOrientation("portrait"),window.showToast&&window.showToast("Canvas restablecido")}setupEventListeners(){}saveCustomSize(e,t,n){this.customSizes.push({name:e,width:t,height:n}),localStorage.setItem("dragndrop_custom_sizes",JSON.stringify(this.customSizes))}loadCustomSizes(){try{const e=localStorage.getItem("dragndrop_custom_sizes");return e?JSON.parse(e):[]}catch(e){return[]}}}void 0!==t&&t.exports&&(t.exports=H),window.ResponsiveTester=H;class R{constructor(){this.previewWindow=null,this.isLive=!1,this.updateInterval=null,this.updateDelay=1e3}start(){this.isLive?window.showToast&&window.showToast("Vista previa ya est√° activa"):(this.openPreviewWindow(),this.startUpdates(),this.isLive=!0,window.showToast&&window.showToast("Vista previa en vivo iniciada"))}stop(){this.isLive&&(this.stopUpdates(),this.previewWindow&&!this.previewWindow.closed&&this.previewWindow.close(),this.previewWindow=null,this.isLive=!1,window.showToast&&window.showToast("Vista previa detenida"))}openPreviewWindow(){const e=screen.width/2-600,t=screen.height/2-400;this.previewWindow=window.open("","Live Preview",`width=1200,height=800,left=${e},top=${t},resizable=yes,scrollbars=yes`),this.previewWindow?this.updatePreview():window.showToast&&window.showToast("No se pudo abrir la ventana de vista previa. Verifica los permisos de ventanas emergentes.","error")}updatePreview(){if(!this.previewWindow||this.previewWindow.closed)return void this.stop();const e=document.getElementById("canvas");if(!e)return;const t=this.generatePreviewHTML(e);try{this.previewWindow.document.open(),this.previewWindow.document.write(t),this.previewWindow.document.close()}catch(n){console.error("Error actualizando preview:",n),this.stop()}}generatePreviewHTML(e){const t=e.cloneNode(!0);t.querySelectorAll(".canvas-element").forEach(e=>{e.classList.remove("canvas-element","selected");const t=e.querySelector(".delete-btn");t&&t.remove(),e.removeAttribute("draggable"),e.removeAttribute("data-component-type")});const n=this.collectStyles(),o=this.collectScripts();return`<!DOCTYPE html>\n<html lang="es">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Vista Previa en Vivo</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        body {\n            font-family: system-ui, -apple-system, sans-serif;\n        }\n        ${n}\n    </style>\n</head>\n<body>\n    ${t.innerHTML}\n    ${o}\n    <script>\n        // Auto-actualizaci√≥n cada 2 segundos\n        setInterval(() => {\n            if (window.opener && !window.opener.closed) {\n                // La ventana padre actualizar√° este contenido\n            } else {\n                document.body.innerHTML = '<div style="padding: 40px; text-align: center; color: #666;"><h2>Vista previa desconectada</h2><p>La ventana del editor fue cerrada.</p></div>';\n            }\n        }, 2000);\n    <\/script>\n</body>\n</html>`}collectStyles(){const e=[];return document.querySelectorAll("style").forEach((t,n)=>{t.getAttribute("data-source")&&t.getAttribute("data-source").startsWith("imported")&&e.push(t.textContent)}),e.push("\n            .component-card {\n                border: 1px solid #e2e8f0;\n                border-radius: 8px;\n                background: white;\n                box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n                max-width: 400px;\n            }\n            .component-card img {\n                width: 100%;\n                border-radius: 8px 8px 0 0;\n            }\n            .component-card-body {\n                padding: 20px;\n            }\n            .component-navbar {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 16px 32px;\n                background: #1e293b;\n                color: white;\n            }\n            .component-navbar-brand {\n                font-size: 1.5rem;\n                font-weight: bold;\n            }\n            .component-navbar-nav {\n                display: flex;\n                gap: 20px;\n                list-style: none;\n            }\n            .component-navbar-nav a {\n                color: white;\n                text-decoration: none;\n            }\n            .component-hero {\n                min-height: 400px;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n                color: white;\n                text-align: center;\n                padding: 60px 20px;\n            }\n            .component-footer {\n                background: #1e293b;\n                color: white;\n                padding: 40px 20px;\n                text-align: center;\n            }\n        "),e.join("\n\n")}collectScripts(){const e=[];return document.querySelectorAll("script").forEach(t=>{t.getAttribute("data-source")&&t.getAttribute("data-source").startsWith("imported")&&(t.src?e.push(`<script src="${t.src}"><\/script>`):e.push(`<script>${t.textContent}<\/script>`))}),e.join("\n")}startUpdates(){this.stopUpdates(),this.updatePreview(),this.updateInterval=setInterval(()=>{this.updatePreview()},this.updateDelay);const e=document.getElementById("canvas");e&&(this.canvasObserver=new MutationObserver(()=>{clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updatePreview()},500)}),this.canvasObserver.observe(e,{childList:!0,subtree:!0,attributes:!0,characterData:!0}))}stopUpdates(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=null),this.canvasObserver&&(this.canvasObserver.disconnect(),this.canvasObserver=null)}toggle(){this.isLive?this.stop():this.start()}isActive(){return this.isLive&&this.previewWindow&&!this.previewWindow.closed}}void 0!==t&&t.exports&&(t.exports=R),window.LivePreview=R;class N{constructor(){this.currentTheme="light",this.storageKey="dragndrop_theme",this.init()}init(){this.loadTheme(),this.setupToggle(),this.setupKeyboardShortcut(),this.watchSystemPreference()}loadTheme(){const e=localStorage.getItem(this.storageKey);this.currentTheme=e||this.detectPreference(),this.applyTheme(this.currentTheme)}detectPreference(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}watchSystemPreference(){window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem(this.storageKey)||(this.currentTheme=e.matches?"dark":"light",this.applyTheme(this.currentTheme))})}toggle(){this.currentTheme="light"===this.currentTheme?"dark":"light",this.applyTheme(this.currentTheme),this.saveTheme(),window.showToast&&window.showToast(`Tema ${"dark"===this.currentTheme?"oscuro":"claro"} activado`)}applyTheme(e){document.documentElement.setAttribute("data-theme",e),this.updateUI(e)}saveTheme(){localStorage.setItem(this.storageKey,this.currentTheme)}updateUI(e){const t=document.getElementById("themeToggle");t&&(t.textContent="dark"===e?"‚òÄÔ∏è Claro":"üåô Oscuro",t.setAttribute("aria-label","Cambiar a modo "+("dark"===e?"claro":"oscuro")),t.classList.toggle("active","dark"===e))}setupToggle(){}setupKeyboardShortcut(){document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),this.toggle())})}getCurrentTheme(){return this.currentTheme}setTheme(e){"light"!==e&&"dark"!==e||(this.currentTheme=e,this.applyTheme(e),this.saveTheme())}}void 0!==t&&t.exports&&(t.exports=N),window.ThemeManager=N;class O{constructor(){this.apiKey=null,this.endpoint="https://api.blackbox.ai/v1/chat/completions",this.model="blackbox",this.isConfigured=!1,this.maxTokens=4e3,this.temperature=.7,this.init()}init(){this.loadApiKey(),this.setupUI()}loadApiKey(){const e=localStorage.getItem("dragndrop_blackbox_api_key");e&&(this.apiKey=e,this.isConfigured=!0)}saveApiKey(e){this.apiKey=e,localStorage.setItem("dragndrop_blackbox_api_key",e),this.isConfigured=!0,window.showToast&&window.showToast("API Key guardada correctamente")}setupUI(){}generateFromDescription(e){return u(this,arguments,function*(e,t={}){if(!this.isConfigured)throw new Error("API Key no configurada. Configure primero en Settings.");const n=this.buildPrompt(e,t);try{const e=yield this.callBlackboxAPI(n);return this.parseResponse(e)}catch(o){throw console.error("Error generando c√≥digo:",o),o}})}generateFromImage(e){return u(this,arguments,function*(e,t={}){if(!this.isConfigured)throw new Error("API Key no configurada");const n=this.buildImagePrompt(e,t);try{const t=yield this.callBlackboxAPI(n,{includeImage:!0,imageData:e});return this.parseResponse(t)}catch(o){throw console.error("Error generando desde imagen:",o),o}})}improveCode(e,t){return u(this,null,function*(){if(!this.isConfigured)throw new Error("API Key no configurada");const n=`Mejora este c√≥digo HTML/CSS siguiendo esta instrucci√≥n: "${t}"\n\nC√≥digo actual:\n\`\`\`html\n${e}\n\`\`\`\n\nRetorna el c√≥digo mejorado manteniendo la estructura general pero aplicando la mejora solicitada.\nSolo retorna el c√≥digo, sin explicaciones.`;try{const e=yield this.callBlackboxAPI(n);return this.parseResponse(e)}catch(o){throw console.error("Error mejorando c√≥digo:",o),o}})}generateComponent(e,t="custom"){return u(this,null,function*(){const n=`Genera un componente ${t} en HTML/CSS vanilla basado en esta descripci√≥n:\n\n"${e}"\n\nRequisitos:\n- HTML sem√°ntico y limpio\n- CSS inline (styles en atributos style)\n- Responsive (usar flexbox/grid)\n- Accesible (ARIA labels apropiados)\n- Sin frameworks (vanilla JavaScript si necesario)\n- Colores modernos y profesionales\n- No usar clases externas (todo inline)\n\nRetorna solo el c√≥digo HTML del componente, listo para insertar en el editor.`;try{const o=yield this.callBlackboxAPI(n),i=this.parseResponse(o);return{type:t,html:i.code,description:e,generated:(new Date).toISOString()}}catch(o){throw console.error("Error generando componente:",o),o}})}buildPrompt(e,t={}){const{framework:n="vanilla",responsive:o=!0,accessibility:i=!0,includeJS:r=!1,style:a="modern"}=t;return`Genera c√≥digo HTML/CSS profesional para:\n\n"${e}"\n\nEspecificaciones:\n- Framework: ${n} (no usar librer√≠as externas)\n- Responsive: ${o?"S√≠ - usar flexbox/grid":"No requerido"}\n- Accesibilidad: ${i?"WCAG 2.1 AA compliant":"B√°sica"}\n- JavaScript: ${r?"Incluir si es necesario":"Solo HTML/CSS"}\n- Estilo: ${a} (clean, profesional)\n\nFormato de respuesta:\n\`\`\`html\n[Tu c√≥digo aqu√≠]\n\`\`\`\n\n\`\`\`css\n[CSS separado si aplica]\n\`\`\`\n\n\`\`\`javascript\n[JavaScript si aplica]\n\`\`\`\n\nGenera c√≥digo production-ready, limpio y bien estructurado.`}buildImagePrompt(e,t={}){return"Analiza esta imagen de dise√±o web y genera el c√≥digo HTML/CSS exacto para replicarla.\n\nImagen adjunta: [imagen en base64]\n\nInstrucciones:\n- Replica la estructura visual exactamente\n- Usa colores similares (extr√°elos de la imagen)\n- Mant√©n proporciones y espaciado\n- HTML sem√°ntico\n- CSS inline o en <style>\n- Responsive\n- Sin frameworks\n\nRetorna el c√≥digo completo listo para usar."}callBlackboxAPI(e){return u(this,arguments,function*(e,t={}){var n;const o={model:this.model,messages:[{role:"system",content:"Eres un experto en desarrollo web. Generas c√≥digo HTML, CSS y JavaScript limpio, sem√°ntico y production-ready. Siempre sigues best practices y est√°ndares web modernos."},{role:"user",content:e}],max_tokens:this.maxTokens,temperature:this.temperature,stream:!1};t.includeImage&&t.imageData&&(o.messages[1].content=[{type:"text",text:e},{type:"image_url",image_url:{url:t.imageData}}]);const i=yield fetch(this.endpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify(o)});if(!i.ok){const e=yield i.json().catch(()=>({}));throw new Error(`Blackbox API error: ${i.status} - ${(null==(n=e.error)?void 0:n.message)||"Unknown error"}`)}return yield i.json()})}parseResponse(e){var t,n,o;const i=(null==(o=null==(n=null==(t=e.choices)?void 0:t[0])?void 0:n.message)?void 0:o.content)||"",r=i.match(/```html\n([\s\S]*?)```/),a=i.match(/```css\n([\s\S]*?)```/),s=i.match(/```javascript\n([\s\S]*?)```/);return{html:r?r[1].trim():i.trim(),css:a?a[1].trim():null,js:s?s[1].trim():null,raw:i}}modifyElement(e,t){return u(this,null,function*(){const n=e.outerHTML,o=`Modifica este elemento HTML seg√∫n la instrucci√≥n:\n\nInstrucci√≥n: "${t}"\n\nHTML actual:\n\`\`\`html\n${n}\n\`\`\`\n\nRetorna el HTML modificado manteniendo la estructura general.\nSolo el c√≥digo, sin explicaciones.`;try{const e=yield this.callBlackboxAPI(o);return this.parseResponse(e)}catch(i){throw console.error("Error modificando elemento:",i),i}})}generateFullPage(e,t="landing"){return u(this,null,function*(){const n=`Genera una p√°gina web completa tipo "${t}" basada en:\n\n"${e}"\n\nRequisitos:\n- HTML5 sem√°ntico completo\n- CSS moderno (Flexbox/Grid)\n- Responsive (mobile-first)\n- Secciones t√≠picas de ${t}:\n  ${this.getTypicalSections(t)}\n- Colores profesionales y modernos\n- Tipograf√≠a clara y legible\n- CTAs claros\n- Optimizado para SEO\n- Accesible (WCAG 2.1 AA)\n\nFormato de respuesta:\n\`\`\`html\n<!DOCTYPE html>\n<html lang="es">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>[T√≠tulo apropiado]</title>\n    <style>\n        [CSS aqu√≠]\n    </style>\n</head>\n<body>\n    [Contenido aqu√≠]\n</body>\n</html>\n\`\`\`\n\nGenera c√≥digo production-ready.`;try{const e=yield this.callBlackboxAPI(n);return this.parseResponse(e)}catch(o){throw console.error("Error generando p√°gina:",o),o}})}getTypicalSections(e){const t={landing:"- Hero con CTA\n  - Features (3-6 items)\n  - Social proof\n  - CTA final\n  - Footer",blog:"- Header con navegaci√≥n\n  - Hero article\n  - Art√≠culos recientes\n  - Sidebar\n  - Footer",portfolio:"- Hero personal\n  - Proyectos destacados\n  - Skills\n  - Contacto\n  - Footer",ecommerce:"- Header con carrito\n  - Hero/Banner\n  - Productos destacados\n  - Categor√≠as\n  - Footer",saas:"- Navbar\n  - Hero con demo\n  - Features\n  - Pricing\n  - Testimonials\n  - CTA\n  - Footer"};return t[e]||t.landing}optimizeCode(e){return u(this,null,function*(){const t=`Optimiza este c√≥digo para performance y best practices:\n\nHTML:\n\`\`\`html\n${e.html}\n\`\`\`\n\n${e.css?`CSS:\n\`\`\`css\n${e.css}\n\`\`\``:""}\n\n${e.js?`JavaScript:\n\`\`\`javascript\n${e.js}\n\`\`\``:""}\n\nOptimizaciones a aplicar:\n- Minificar espacios innecesarios\n- Mejorar sem√°ntica HTML\n- Optimizar selectores CSS\n- Reducir redundancia\n- Mejorar accesibilidad\n- SEO optimization\n\nRetorna el c√≥digo optimizado en el mismo formato.`;try{const e=yield this.callBlackboxAPI(t);return this.parseResponse(e)}catch(n){throw console.error("Error optimizando c√≥digo:",n),n}})}canvasToCode(){return u(this,null,function*(){const e=document.getElementById("canvas");if(!e)throw new Error("Canvas no encontrado");const t=e.innerHTML,n=yield this.captureCanvasScreenshot(),o=`Analiza este HTML generado por un editor visual y convi√©rtelo a c√≥digo production-ready limpio:\n\nHTML actual (generado por editor):\n\`\`\`html\n${t}\n\`\`\`\n\nInstrucciones:\n1. Remover clases del editor (canvas-element, selected, etc)\n2. Remover atributos del editor (draggable, data-component-type)\n3. Remover botones de delete\n4. Limpiar IDs autogenerados (element-XXX) por IDs sem√°nticos\n5. Organizar c√≥digo con indentaci√≥n correcta\n6. Extraer CSS inline a <style> cuando sea apropiado\n7. Agregar comentarios para secciones principales\n8. Optimizar para SEO (meta tags apropiados)\n9. Hacer responsive si no lo es\n\nRetorna HTML completo production-ready.`;try{const e=yield this.callBlackboxAPI(o),i=this.parseResponse(e);return p(d({},i),{screenshot:n,original:t})}catch(i){throw console.error("Error convirtiendo canvas:",i),i}})}captureCanvasScreenshot(){return u(this,null,function*(){const e=document.getElementById("canvas");if(!e)return null;if("undefined"!=typeof html2canvas)try{return(yield html2canvas(e)).toDataURL("image/png")}catch(t){return console.error("Error capturando screenshot:",t),null}return null})}generateVariations(e,t=3){return u(this,null,function*(){var n,o,i;const r=e.outerHTML,a=`Genera ${t} variaciones de este componente HTML:\n\n\`\`\`html\n${r}\n\`\`\`\n\nCada variaci√≥n debe:\n- Mantener la estructura general\n- Cambiar colores/estilos\n- Tener personalidad diferente (elegante, moderno, minimalista, etc)\n- Ser igualmente funcional\n\nRetorna las ${t} variaciones separadas por "---VARIATION---".`;try{const e=(null==(i=null==(o=null==(n=(yield this.callBlackboxAPI(a)).choices)?void 0:n[0])?void 0:o.message)?void 0:i.content)||"";return e.split("---VARIATION---").map(e=>e.trim()).filter(e=>e.length>0).map((e,t)=>({id:`variation-${t}`,html:this.extractCodeBlock(e),index:t}))}catch(s){throw console.error("Error generando variaciones:",s),s}})}extractCodeBlock(e){const t=e.match(/```(?:html)?\n([\s\S]*?)```/);return t?t[1].trim():e.trim()}fixHTMLErrors(e){return u(this,null,function*(){const t=`Corrige errores de sintaxis y estructura en este HTML:\n\n\`\`\`html\n${e}\n\`\`\`\n\nCorrecciones a aplicar:\n- Cerrar tags abiertos\n- Corregir anidamiento\n- Validar atributos\n- Arreglar comillas\n- Hacer v√°lido HTML5\n\nRetorna HTML corregido.`;try{const e=yield this.callBlackboxAPI(t);return this.parseResponse(e)}catch(n){throw console.error("Error corrigiendo HTML:",n),n}})}suggestImprovements(e){return u(this,null,function*(){var t,n,o;const i=`Analiza este c√≥digo HTML/CSS y sugiere mejoras:\n\n\`\`\`html\n${e}\n\`\`\`\n\nAnaliza:\n- Accesibilidad\n- Performance\n- SEO\n- Sem√°ntica\n- Best practices\n- Responsive design\n\nRetorna lista de sugerencias en formato:\n1. [Mejora] - [Raz√≥n] - [Prioridad: Alta/Media/Baja]`;try{const e=(null==(o=null==(n=null==(t=(yield this.callBlackboxAPI(i)).choices)?void 0:t[0])?void 0:n.message)?void 0:o.content)||"";return e.split("\n").filter(e=>/^\d+\./.test(e)).map(e=>{var t;const n=e.split(" - ");return{improvement:null==(t=n[0])?void 0:t.replace(/^\d+\.\s*/,""),reason:n[1]||"",priority:n[2]||"Media"}})}catch(r){throw console.error("Error generando sugerencias:",r),r}})}isReady(){return this.isConfigured&&null!==this.apiKey}showConfigDialog(){const e=document.createElement("div");e.className="modal",e.innerHTML=`\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>‚öôÔ∏è Configurar AI Code Generator</h3>\n                    <button class="modal-close" onclick="this.closest('.modal').remove()">&times;</button>\n                </div>\n                <div class="modal-body">\n                    <div class="form-group">\n                        <label>Blackbox API Key:</label>\n                        <input type="password" id="blackboxApiKey" placeholder="sk-..." value="${this.apiKey||""}">\n                        <small style="color: var(--text-secondary); display: block; margin-top: 4px;">\n                            Obt√©n tu API key en: <a href="https://www.blackbox.ai/api" target="_blank">blackbox.ai/api</a>\n                        </small>\n                    </div>\n                    <div class="form-group">\n                        <label>Modelo:</label>\n                        <select id="aiModel">\n                            <option value="blackbox" ${"blackbox"===this.model?"selected":""}>Blackbox (R√°pido)</option>\n                            <option value="claude-3-sonnet" ${"claude-3-sonnet"===this.model?"selected":""}>Claude 3 Sonnet (Preciso)</option>\n                            <option value="gpt-4" ${"gpt-4"===this.model?"selected":""}>GPT-4 (Potente)</option>\n                        </select>\n                    </div>\n                    <div class="modal-actions">\n                        <button class="btn primary" onclick="window.aiCodeGenerator.saveConfig()">Guardar</button>\n                        <button class="btn" onclick="this.closest('.modal').remove()">Cancelar</button>\n                    </div>\n                </div>\n            </div>\n        `,document.body.appendChild(e)}saveConfig(){var e,t;const n=null==(e=document.getElementById("blackboxApiKey"))?void 0:e.value,o=null==(t=document.getElementById("aiModel"))?void 0:t.value;if(n&&n.trim()){this.saveApiKey(n.trim()),this.model=o||"blackbox";const e=document.querySelector(".modal");e&&e.remove(),window.showToast&&window.showToast("Configuraci√≥n guardada. AI Code Generator listo!")}else alert("Por favor ingresa una API key v√°lida")}showGenerateDialog(){if(!this.isReady())return void this.showConfigDialog();const e=document.createElement("div");e.className="modal ai-generate-modal",e.innerHTML='\n            <div class="modal-content" style="max-width: 700px;">\n                <div class="modal-header">\n                    <h3>ü§ñ Generar con AI</h3>\n                    <button class="modal-close" onclick="this.closest(\'.modal\').remove()">&times;</button>\n                </div>\n                <div class="modal-body">\n                    <div class="form-group">\n                        <label>Describe lo que quieres crear:</label>\n                        <textarea id="aiPrompt" rows="4" style="width: 100%; padding: 10px; border: 1px solid var(--border-primary); border-radius: 6px; font-family: inherit; resize: vertical;" placeholder="Ej: Un hero section moderno con gradiente azul, t√≠tulo grande, subt√≠tulo y dos botones (primario y secundario)"></textarea>\n                    </div>\n                    <div class="form-group">\n                        <label>Tipo de componente:</label>\n                        <select id="aiComponentType" style="width: 100%; padding: 10px; border: 1px solid var(--border-primary); border-radius: 6px;">\n                            <option value="custom">Personalizado</option>\n                            <option value="navbar">Navbar</option>\n                            <option value="hero">Hero Section</option>\n                            <option value="card">Card</option>\n                            <option value="footer">Footer</option>\n                            <option value="form">Formulario</option>\n                            <option value="gallery">Galer√≠a</option>\n                            <option value="pricing">Pricing Table</option>\n                        </select>\n                    </div>\n                    <div class="modal-actions">\n                        <button class="btn primary" onclick="window.aiCodeGenerator.executeGeneration()" id="generateBtn">\n                            ‚ú® Generar\n                        </button>\n                        <button class="btn" onclick="this.closest(\'.modal\').remove()">Cancelar</button>\n                    </div>\n                    <div id="aiGenerationResult" style="margin-top: 20px; display: none;">\n                        <h4>C√≥digo Generado:</h4>\n                        <pre style="background: var(--bg-secondary); padding: 15px; border-radius: 6px; overflow-x: auto; max-height: 300px;"><code id="generatedCode"></code></pre>\n                        <div style="margin-top: 10px;">\n                            <button class="btn primary" onclick="window.aiCodeGenerator.insertGeneratedCode()">Insertar en Canvas</button>\n                            <button class="btn" onclick="navigator.clipboard.writeText(document.getElementById(\'generatedCode\').textContent)">Copiar C√≥digo</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ',document.body.appendChild(e)}executeGeneration(){return u(this,null,function*(){var e,t;const n=null==(e=document.getElementById("aiPrompt"))?void 0:e.value,o=null==(t=document.getElementById("aiComponentType"))?void 0:t.value,i=document.getElementById("generateBtn");if(n&&n.trim()){i&&(i.disabled=!0,i.textContent="‚è≥ Generando...");try{const e=yield this.generateComponent(n.trim(),o),t=document.getElementById("aiGenerationResult"),i=document.getElementById("generatedCode");t&&i&&(i.textContent=e.html,t.style.display="block",this.lastGenerated=e.html),window.showToast&&window.showToast("C√≥digo generado con AI")}catch(r){alert(`Error generando c√≥digo: ${r.message}`),console.error(r)}finally{i&&(i.disabled=!1,i.textContent="‚ú® Generar")}}else alert("Por favor describe lo que quieres crear")})}insertGeneratedCode(){if(!this.lastGenerated)return;const e=document.getElementById("canvas");if(!e)return;const t=document.createElement("div");t.innerHTML=this.lastGenerated;const n=t.firstElementChild;if(n){n.id="element-"+window.elementIdCounter++,n.classList.add("canvas-element");const t=document.createElement("div");t.className="delete-btn",t.textContent="√ó",t.onclick=e=>{e.stopPropagation(),window.deleteElement&&window.deleteElement(n)},n.appendChild(t),n.addEventListener("click",e=>{e.stopPropagation(),window.selectElement&&window.selectElement(n)}),n.addEventListener("dblclick",e=>{e.stopPropagation(),window.makeElementEditable&&window.makeElementEditable(n)}),e.appendChild(n);const o=document.querySelector(".ai-generate-modal");o&&o.remove(),window.showToast&&window.showToast("Componente AI insertado en canvas")}}getStatus(){return{configured:this.isConfigured,model:this.model,endpoint:this.endpoint,hasApiKey:null!==this.apiKey}}}void 0!==t&&t.exports&&(t.exports=O),window.AICodeGenerator=O;const F=document.createElement("style");F.textContent="\n    /* Badge de sugerencia */\n    .syntax-suggestion-badge {\n        position: absolute;\n        top: -35px;\n        left: 50%;\n        transform: translateX(-50%);\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        padding: 8px 12px;\n        border-radius: 8px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        font-size: 12px;\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n        z-index: 1000;\n        animation: suggestBounce 0.5s ease;\n        white-space: nowrap;\n    }\n\n    @keyframes suggestBounce {\n        0%, 100% { transform: translateX(-50%) translateY(0); }\n        50% { transform: translateX(-50%) translateY(-5px); }\n    }\n\n    .syntax-suggestion-badge .badge-icon {\n        font-size: 14px;\n    }\n\n    .syntax-suggestion-badge .badge-text {\n        font-weight: 500;\n    }\n\n    .syntax-suggestion-badge button {\n        padding: 4px 10px;\n        border: none;\n        border-radius: 4px;\n        cursor: pointer;\n        font-size: 11px;\n        font-weight: 600;\n        transition: all 0.2s;\n    }\n\n    .badge-apply-btn {\n        background: white;\n        color: #667eea;\n    }\n\n    .badge-apply-btn:hover {\n        background: #f0f0f0;\n    }\n\n    .badge-dismiss-btn {\n        background: rgba(255, 255, 255, 0.2);\n        color: white;\n        width: 20px;\n        height: 20px;\n        padding: 0;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .badge-dismiss-btn:hover {\n        background: rgba(255, 255, 255, 0.3);\n    }\n\n    /* Modal de configuraci√≥n */\n    .gemini-config-modal {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100vh;\n        z-index: 3000;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .gemini-config-modal .modal-overlay {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n    }\n\n    .gemini-config-modal .modal-content {\n        background: white;\n        border-radius: 12px;\n        width: 90%;\n        max-width: 500px;\n        position: relative;\n        z-index: 10;\n        box-shadow: 0 20px 25px -5px rgba(0,0,0,0.3);\n    }\n\n    .gemini-config-modal .modal-header {\n        padding: 20px 24px;\n        border-bottom: 1px solid #e2e8f0;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n\n    .gemini-config-modal .modal-header h3 {\n        margin: 0;\n        font-size: 18px;\n        color: #1e293b;\n    }\n\n    .gemini-config-modal .modal-close-btn {\n        background: none;\n        border: none;\n        font-size: 24px;\n        cursor: pointer;\n        color: #64748b;\n        padding: 0;\n        width: 30px;\n        height: 30px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .gemini-config-modal .modal-body {\n        padding: 24px;\n    }\n\n    .gemini-config-modal .config-info {\n        background: #f8fafc;\n        padding: 16px;\n        border-radius: 8px;\n        margin-bottom: 20px;\n    }\n\n    .gemini-config-modal .config-info p {\n        margin: 0 0 10px 0;\n        color: #475569;\n        font-size: 14px;\n        line-height: 1.6;\n    }\n\n    .gemini-config-modal .config-info p:last-child {\n        margin-bottom: 0;\n    }\n\n    .gemini-config-modal .config-info a {\n        color: #2563eb;\n        text-decoration: none;\n        font-weight: 500;\n        display: inline-block;\n        margin-top: 8px;\n    }\n\n    .gemini-config-modal .config-info a:hover {\n        text-decoration: underline;\n    }\n\n    .gemini-config-modal .form-group {\n        margin-bottom: 20px;\n    }\n\n    .gemini-config-modal .form-group label {\n        display: block;\n        margin-bottom: 8px;\n        font-weight: 500;\n        color: #1e293b;\n        font-size: 14px;\n    }\n\n    .gemini-config-modal .form-group input {\n        width: 100%;\n        padding: 10px 12px;\n        border: 1px solid #e2e8f0;\n        border-radius: 6px;\n        font-size: 14px;\n        font-family: monospace;\n    }\n\n    .gemini-config-modal .form-group input:focus {\n        outline: none;\n        border-color: #2563eb;\n        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);\n    }\n\n    .gemini-config-modal .config-status {\n        text-align: center;\n        padding: 12px;\n        border-radius: 6px;\n        background: #f8fafc;\n    }\n\n    .gemini-config-modal .status-enabled {\n        color: #10b981;\n        font-weight: 600;\n    }\n\n    .gemini-config-modal .status-disabled {\n        color: #f59e0b;\n        font-weight: 600;\n    }\n\n    .gemini-config-modal .modal-footer {\n        padding: 16px 24px;\n        border-top: 1px solid #e2e8f0;\n        display: flex;\n        gap: 12px;\n        justify-content: flex-end;\n    }\n\n    .gemini-config-modal .btn {\n        padding: 10px 20px;\n        border-radius: 6px;\n        font-weight: 500;\n        cursor: pointer;\n        border: none;\n        font-size: 14px;\n        transition: all 0.2s;\n    }\n\n    .gemini-config-modal .btn-primary {\n        background: #2563eb;\n        color: white;\n    }\n\n    .gemini-config-modal .btn-primary:hover {\n        background: #1d4ed8;\n    }\n\n    .gemini-config-modal .btn-secondary {\n        background: #f1f5f9;\n        color: #475569;\n    }\n\n    .gemini-config-modal .btn-secondary:hover {\n        background: #e2e8f0;\n    }\n\n    .gemini-config-modal .btn-danger {\n        background: #ef4444;\n        color: white;\n    }\n\n    .gemini-config-modal .btn-danger:hover {\n        background: #dc2626;\n    }\n",document.head.appendChild(F),window.GeminiSyntaxValidator=class{constructor(){this.apiKey=null,this.apiEndpoint="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-lite:generateContent",this.validationQueue=new Map,this.debounceTimeout=null,this.debounceDelay=1500,this.maxRetries=2,this.enabled=!1,this.loadApiKey()}loadApiKey(){this.apiKey=localStorage.getItem("gemini_api_key"),this.enabled=!!this.apiKey}setApiKey(e){if(!e||""===e.trim())throw new Error("API key inv√°lida");this.apiKey=e.trim(),localStorage.setItem("gemini_api_key",this.apiKey),this.enabled=!0,console.log("‚úÖ Gemini API key configurada")}removeApiKey(){this.apiKey=null,this.enabled=!1,localStorage.removeItem("gemini_api_key"),console.log("üóëÔ∏è Gemini API key eliminada")}isEnabled(){return this.enabled&&null!==this.apiKey}buildPrompt(e,t){const n=e.tagName.toLowerCase(),o=e.outerHTML,i=e.style.cssText;return`Fix HTML/CSS syntax only. Return valid code.\n\nElement: <${n}>\nHTML: ${o.substring(0,500)}\nStyles: ${i}\nParent: ${t.parent||"body"}\n\nRules:\n- Fix syntax errors only\n- Keep semantic structure\n- Validate CSS properties\n- No explanations\n- Return only corrected HTML+inline CSS`}validateElement(e){return u(this,arguments,function*(e,t={}){if(!this.isEnabled())return console.warn("‚ö†Ô∏è Gemini validator no est√° habilitado"),null;const n=e.id||`temp-${Date.now()}`;return this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.validationQueue.set(n,{element:e,context:t}),new Promise(e=>{this.debounceTimeout=setTimeout(()=>u(this,null,function*(){const t=yield this.processBatch();e(t.get(n))}),this.debounceDelay)})})}processBatch(){return u(this,null,function*(){if(0===this.validationQueue.size)return new Map;const e=new Map,t=Array.from(this.validationQueue.entries());for(const[o,{element:i,context:r}]of t)try{const t=yield this.callGeminiAPI(i,r);e.set(o,t)}catch(n){console.error(`Error validando elemento ${o}:`,n),e.set(o,{success:!1,error:n.message})}return this.validationQueue.clear(),e})}callGeminiAPI(e,t,n=0){return u(this,null,function*(){var o;const i={contents:[{parts:[{text:this.buildPrompt(e,t)}]}],generationConfig:{temperature:.1,topK:1,topP:.8,maxOutputTokens:512,stopSequences:[]},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}]};try{const t=yield fetch(`${this.apiEndpoint}?key=${this.apiKey}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const e=yield t.json();throw new Error(`API Error: ${(null==(o=e.error)?void 0:o.message)||t.statusText}`)}const n=yield t.json(),r=this.extractCorrectedCode(n);return{success:!0,original:e.outerHTML,corrected:r,hasChanges:e.outerHTML.trim()!==r.trim(),timestamp:Date.now()}}catch(r){if(n<this.maxRetries&&r.message.includes("429"))return console.log(`‚è≥ Rate limit alcanzado, reintentando... (${n+1}/${this.maxRetries})`),yield this.sleep(2e3*(n+1)),this.callGeminiAPI(e,t,n+1);throw r}})}extractCorrectedCode(e){try{const t=e.candidates;if(!t||0===t.length)throw new Error("No candidates in response");const n=t[0].content;if(!n||!n.parts||0===n.parts.length)throw new Error("No content in response");let o=n.parts[0].text.trim();return o=o.replace(/```html\n?/g,"").replace(/```\n?/g,""),o}catch(t){throw console.error("Error extrayendo c√≥digo corregido:",t),new Error("No se pudo extraer el c√≥digo corregido de la respuesta")}}applyCorrection(e,t){if(!t.success||!t.hasChanges)return!1;try{const n=document.createElement("div");n.innerHTML=t.corrected;const o=n.firstElementChild;if(!o)throw new Error("No se pudo parsear el elemento corregido");return o.id=e.id,o.classList.add("canvas-element"),e.classList.contains("selected")&&o.classList.add("selected"),e.parentNode.replaceChild(o,e),console.log("‚úÖ Correcci√≥n aplicada:",o.outerHTML.substring(0,100)),!0}catch(n){return console.error("Error aplicando correcci√≥n:",n),!1}}showCorrectionSuggestion(e,t){if(!t.success||!t.hasChanges)return;const n=e.querySelector(".syntax-suggestion-badge");n&&n.remove();const o=document.createElement("div");o.className="syntax-suggestion-badge",o.innerHTML='\n            <span class="badge-icon">üí°</span>\n            <span class="badge-text">Mejora disponible</span>\n            <button class="badge-apply-btn" data-action="apply">Aplicar</button>\n            <button class="badge-dismiss-btn" data-action="dismiss">√ó</button>\n        ',o.querySelector('[data-action="apply"]').addEventListener("click",n=>{n.stopPropagation(),this.applyCorrection(e,t),o.remove(),window.showToast&&window.showToast("‚úÖ Correcci√≥n aplicada")}),o.querySelector('[data-action="dismiss"]').addEventListener("click",e=>{e.stopPropagation(),o.remove()}),e.appendChild(o)}showConfigModal(){const e=document.createElement("div");e.className="gemini-config-modal",e.innerHTML=`\n            <div class="modal-overlay"></div>\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h3>‚öôÔ∏è Configuraci√≥n Gemini API</h3>\n                    <button class="modal-close-btn">√ó</button>\n                </div>\n                <div class="modal-body">\n                    <div class="config-info">\n                        <p>Para habilitar la validaci√≥n sint√°ctica autom√°tica, necesitas una API key de Google Gemini.</p>\n                        <p><strong>Modelo usado:</strong> gemini-2.0-flash-lite (optimizado para bajo costo)</p>\n                        <a href="https://makersuite.google.com/app/apikey" target="_blank" rel="noopener">\n                            üîó Obtener API Key gratuita\n                        </a>\n                    </div>\n                    \n                    <div class="form-group">\n                        <label for="gemini-api-key-input">API Key</label>\n                        <input \n                            type="password" \n                            id="gemini-api-key-input" \n                            placeholder="AIza..." \n                            value="${this.apiKey||""}"\n                        >\n                    </div>\n                    \n                    <div class="config-status">\n                        ${this.isEnabled()?'<span class="status-enabled">‚úÖ Habilitado</span>':'<span class="status-disabled">‚ö†Ô∏è Deshabilitado</span>'}\n                    </div>\n                </div>\n                <div class="modal-footer">\n                    <button class="btn btn-secondary" data-action="cancel">Cancelar</button>\n                    ${this.isEnabled()?'<button class="btn btn-danger" data-action="remove">Eliminar Key</button>':""}\n                    <button class="btn btn-primary" data-action="save">Guardar</button>\n                </div>\n            </div>\n        `;const t=()=>e.remove();e.querySelector(".modal-close-btn").addEventListener("click",t),e.querySelector(".modal-overlay").addEventListener("click",t),e.querySelector('[data-action="cancel"]').addEventListener("click",t),e.querySelector('[data-action="save"]').addEventListener("click",()=>{const n=e.querySelector("#gemini-api-key-input").value.trim();if(n)try{this.setApiKey(n),window.showToast&&window.showToast("‚úÖ API Key guardada correctamente"),t()}catch(o){alert(o.message)}else alert("Por favor ingresa una API key v√°lida")});const n=e.querySelector('[data-action="remove"]');n&&n.addEventListener("click",()=>{confirm("¬øSeguro que deseas eliminar la API key?")&&(this.removeApiKey(),window.showToast&&window.showToast("üóëÔ∏è API Key eliminada"),t())}),document.body.appendChild(e)}sleep(e){return new Promise(t=>setTimeout(t,e))}},window.ResizeManager=class{constructor(){this.activeElement=null,this.resizing=!1,this.startX=0,this.startY=0,this.startWidth=0,this.startHeight=0,this.currentHandle=null,this.minWidth=20,this.minHeight=20,this.aspectRatio=null,this.preserveAspectRatio=!1,this.handles=[{name:"nw",cursor:"nw-resize",position:"top-left"},{name:"n",cursor:"n-resize",position:"top-center"},{name:"ne",cursor:"ne-resize",position:"top-right"},{name:"e",cursor:"e-resize",position:"middle-right"},{name:"se",cursor:"se-resize",position:"bottom-right"},{name:"s",cursor:"s-resize",position:"bottom-center"},{name:"sw",cursor:"sw-resize",position:"bottom-left"},{name:"w",cursor:"w-resize",position:"middle-left"}],this.init()}init(){this.injectStyles(),document.addEventListener("mousemove",this.handleMouseMove.bind(this)),document.addEventListener("mouseup",this.handleMouseUp.bind(this)),document.addEventListener("keydown",this.handleKeyDown.bind(this)),console.log("‚úÖ ResizeManager inicializado")}enableResize(e){if(!e||e.classList.contains("resize-enabled"))return;e.classList.add("resize-enabled");const t=document.createElement("div");t.className="resize-handles",this.handles.forEach(n=>{const o=document.createElement("div");o.className=`resize-handle resize-handle-${n.name}`,o.dataset.handle=n.name,o.style.cursor=n.cursor,o.addEventListener("mousedown",t=>{this.startResize(t,e,n.name)}),t.appendChild(o)}),e.appendChild(t)}disableResize(e){if(!e)return;e.classList.remove("resize-enabled");const t=e.querySelector(".resize-handles");t&&t.remove()}startResize(e,t,n){e.preventDefault(),e.stopPropagation(),this.resizing=!0,this.activeElement=t,this.currentHandle=n,this.startX=e.clientX,this.startY=e.clientY;const o=window.getComputedStyle(t);this.startWidth=parseFloat(o.width),this.startHeight=parseFloat(o.height),this.aspectRatio=this.startWidth/this.startHeight,this.preserveAspectRatio=e.shiftKey,t.classList.add("resizing"),document.body.classList.add("resizing-active"),this.dispatchEvent("resizestart",{element:t,width:this.startWidth,height:this.startHeight})}handleMouseMove(e){if(!this.resizing||!this.activeElement)return;e.preventDefault();const t=e.clientX-this.startX,n=e.clientY-this.startY;let o=this.startWidth,i=this.startHeight;switch(this.currentHandle){case"e":o=this.startWidth+t;break;case"w":o=this.startWidth-t;break;case"s":i=this.startHeight+n;break;case"n":i=this.startHeight-n;break;case"se":o=this.startWidth+t,i=this.startHeight+n;break;case"sw":o=this.startWidth-t,i=this.startHeight+n;break;case"ne":o=this.startWidth+t,i=this.startHeight-n;break;case"nw":o=this.startWidth-t,i=this.startHeight-n}(this.preserveAspectRatio||e.shiftKey)&&(this.currentHandle.includes("e")||this.currentHandle.includes("w")?i=o/this.aspectRatio:(this.currentHandle.includes("n")||this.currentHandle.includes("s"))&&(o=i*this.aspectRatio)),o=Math.max(this.minWidth,o),i=Math.max(this.minHeight,i),this.activeElement.style.width=o+"px",this.activeElement.style.height=i+"px",this.showDimensionsTooltip(o,i),this.dispatchEvent("resizing",{element:this.activeElement,width:o,height:i})}handleMouseUp(e){if(this.resizing){if(this.resizing=!1,this.activeElement){this.activeElement.classList.remove("resizing");const e=parseFloat(this.activeElement.style.width),t=parseFloat(this.activeElement.style.height);this.dispatchEvent("resizeend",{element:this.activeElement,width:e,height:t})}document.body.classList.remove("resizing-active"),this.hideDimensionsTooltip(),this.activeElement=null,this.currentHandle=null}}handleKeyDown(e){"Escape"===e.key&&this.resizing&&this.cancelResize(),"Shift"===e.key&&this.resizing&&(this.preserveAspectRatio=!0)}cancelResize(){this.resizing&&this.activeElement&&(this.activeElement.style.width=this.startWidth+"px",this.activeElement.style.height=this.startHeight+"px",this.handleMouseUp(new Event("mouseup")),window.showToast&&window.showToast("‚è™ Resize cancelado"))}showDimensionsTooltip(e,t){let n=document.getElementById("resize-dimensions-tooltip");n||(n=document.createElement("div"),n.id="resize-dimensions-tooltip",n.className="resize-dimensions-tooltip",document.body.appendChild(n)),n.textContent=`${Math.round(e)} √ó ${Math.round(t)} px`,n.style.display="block";const o=this.activeElement.getBoundingClientRect();n.style.left=o.left+o.width/2+"px",n.style.top=o.bottom+10+"px"}hideDimensionsTooltip(){const e=document.getElementById("resize-dimensions-tooltip");e&&(e.style.display="none")}setDimensions(e,t,n){e&&(e.style.width=t+"px",e.style.height=n+"px",this.dispatchEvent("dimensionschanged",{element:e,width:t,height:n}))}resetDimensions(e){e&&(e.style.width="",e.style.height="",this.dispatchEvent("dimensionsreset",{element:e}))}fitToContent(e){e&&(e.style.width="fit-content",e.style.height="auto",this.dispatchEvent("fittocontent",{element:e}))}dispatchEvent(e,t){const n=new CustomEvent(`resize:${e}`,{detail:t,bubbles:!0});t.element&&t.element.dispatchEvent(n),window.dispatchEvent(n)}injectStyles(){const e="resize-manager-styles";if(document.getElementById(e))return;const t=document.createElement("style");t.id=e,t.textContent="\n            /* Contenedor de handles */\n            .resize-handles {\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                pointer-events: none;\n                z-index: 999;\n                display: none;\n            }\n\n            .canvas-element.selected .resize-handles {\n                display: block;\n            }\n\n            /* Handles individuales */\n            .resize-handle {\n                position: absolute;\n                width: 10px;\n                height: 10px;\n                background: white;\n                border: 2px solid #2563eb;\n                border-radius: 50%;\n                pointer-events: auto;\n                z-index: 1000;\n                transition: all 0.2s;\n            }\n\n            .resize-handle:hover {\n                transform: scale(1.3);\n                background: #2563eb;\n                box-shadow: 0 0 8px rgba(37, 99, 235, 0.5);\n            }\n\n            /* Posiciones de handles */\n            .resize-handle-nw { top: -5px; left: -5px; }\n            .resize-handle-n { top: -5px; left: 50%; transform: translateX(-50%); }\n            .resize-handle-ne { top: -5px; right: -5px; }\n            .resize-handle-e { top: 50%; right: -5px; transform: translateY(-50%); }\n            .resize-handle-se { bottom: -5px; right: -5px; }\n            .resize-handle-s { bottom: -5px; left: 50%; transform: translateX(-50%); }\n            .resize-handle-sw { bottom: -5px; left: -5px; }\n            .resize-handle-w { top: 50%; left: -5px; transform: translateY(-50%); }\n\n            /* Estado resizing */\n            .canvas-element.resizing {\n                outline: 2px solid #2563eb !important;\n                opacity: 0.8;\n            }\n\n            body.resizing-active {\n                cursor: inherit !important;\n                user-select: none;\n            }\n\n            body.resizing-active * {\n                cursor: inherit !important;\n            }\n\n            /* Tooltip de dimensiones */\n            .resize-dimensions-tooltip {\n                position: fixed;\n                background: rgba(37, 99, 235, 0.95);\n                color: white;\n                padding: 6px 12px;\n                border-radius: 6px;\n                font-size: 12px;\n                font-weight: 600;\n                pointer-events: none;\n                z-index: 10000;\n                transform: translateX(-50%);\n                box-shadow: 0 4px 6px rgba(0,0,0,0.2);\n                display: none;\n                white-space: nowrap;\n                animation: tooltipFadeIn 0.2s ease;\n            }\n\n            @keyframes tooltipFadeIn {\n                from {\n                    opacity: 0;\n                    transform: translateX(-50%) translateY(-5px);\n                }\n                to {\n                    opacity: 1;\n                    transform: translateX(-50%) translateY(0);\n                }\n            }\n\n            /* Hints visuales */\n            .canvas-element.resize-enabled::after {\n                content: '';\n                position: absolute;\n                bottom: 3px;\n                right: 3px;\n                width: 0;\n                height: 0;\n                border-style: solid;\n                border-width: 0 0 10px 10px;\n                border-color: transparent transparent #94a3b8 transparent;\n                opacity: 0.3;\n                pointer-events: none;\n            }\n\n            .canvas-element.resize-enabled.selected::after {\n                border-color: transparent transparent #2563eb transparent;\n                opacity: 0.5;\n            }\n        ",document.head.appendChild(t)}destroy(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("keydown",this.handleKeyDown);const e=document.getElementById("resize-dimensions-tooltip");e&&e.remove(),console.log("üóëÔ∏è ResizeManager destruido")}},window.EnhancedDragDropManager=class{constructor(){this.draggedElement=null,this.draggedType=null,this.ghostElement=null,this.dropIndicator=null,this.dragPreview=null,this.isDragging=!1,this.dropZones=[],this.snapThreshold=10,this.scrollSpeed=5,this.scrollEdgeSize=50,this.init()}init(){this.injectStyles(),this.createDropIndicator(),this.setupGlobalEvents(),console.log("‚úÖ EnhancedDragDropManager inicializado")}setupGlobalEvents(){document.addEventListener("dragover",this.handleDragOver.bind(this)),document.addEventListener("drop",this.handleDrop.bind(this)),document.addEventListener("dragend",this.handleDragEnd.bind(this))}setupComponentDrag(e,t){e.draggable=!0,e.dataset.componentType=t,e.addEventListener("dragstart",n=>{this.startComponentDrag(n,e,t)}),e.addEventListener("dragend",t=>{this.endComponentDrag(t,e)})}setupCanvasElementDrag(e){if(e.draggable=e.classList.contains("selected"),!e.querySelector(".drag-handle")){const t=document.createElement("div");t.className="drag-handle",t.innerHTML="‚ãÆ‚ãÆ",t.title="Arrastrar para reordenar (o seleccionar elemento)",e.appendChild(t)}e.addEventListener("dragstart",t=>{e.classList.contains("selected")?this.startCanvasElementDrag(t,e):t.preventDefault()}),e.addEventListener("dragend",t=>{this.endCanvasElementDrag(t,e)}),e.addEventListener("click",()=>{e.draggable=e.classList.contains("selected")})}startComponentDrag(e,t,n){this.isDragging=!0,this.draggedType=n,this.draggedElement=null,this.createDragPreview(t,!0),e.dataTransfer.setDragImage(this.dragPreview,0,0),e.dataTransfer.effectAllowed="copy",t.classList.add("dragging"),this.highlightDropZones(),this.dispatchEvent("dragstart",{type:n,isNewComponent:!0})}startCanvasElementDrag(e,t){this.isDragging=!0,this.draggedElement=t,this.draggedType=t.dataset.componentType,this.createDragPreview(t,!1),e.dataTransfer.setDragImage(this.dragPreview,0,0),e.dataTransfer.effectAllowed="move",t.classList.add("dragging-canvas-element"),this.highlightDropZones(),this.dispatchEvent("dragstart",{element:t,type:this.draggedType,isNewComponent:!1})}createDragPreview(e,t){if(this.dragPreview&&this.dragPreview.remove(),this.dragPreview=document.createElement("div"),this.dragPreview.className="drag-preview",t)this.dragPreview.textContent=e.textContent,this.dragPreview.style.padding="10px 20px";else{const t=e.cloneNode(!0);t.querySelectorAll(".delete-btn, .resize-handles, .drag-handle").forEach(e=>e.remove()),this.dragPreview.appendChild(t)}document.body.appendChild(this.dragPreview)}handleDragOver(e){if(!this.isDragging)return;e.preventDefault(),e.dataTransfer.dropEffect=this.draggedElement?"move":"copy",this.handleAutoScroll(e);const t=this.findDropTarget(e);t?this.showDropIndicator(t,e):this.hideDropIndicator()}handleDrop(e){if(!this.isDragging)return;e.preventDefault(),e.stopPropagation();const t=this.findDropTarget(e);if(!t)return void(window.showToast&&window.showToast("‚ö†Ô∏è Zona de drop inv√°lida","warning"));const n=this.calculateInsertPosition(t.element,e);this.draggedElement?this.moveElement(this.draggedElement,t.element,n):this.createNewComponent(this.draggedType,t.element,n),this.dispatchEvent("drop",{type:this.draggedType,target:t.element,position:n})}endComponentDrag(e,t){t.classList.remove("dragging"),this.cleanup()}endCanvasElementDrag(e,t){t.classList.remove("dragging-canvas-element"),this.cleanup()}handleDragEnd(e){this.cleanup()}findDropTarget(e){document.getElementById("canvas");const t=document.elementsFromPoint(e.clientX,e.clientY);for(const n of t){if("canvas"===n.id)return{element:n,type:"canvas",canAcceptChildren:!0};if(n.classList.contains("canvas-element")&&n!==this.draggedElement)return{element:n,type:"element",canAcceptChildren:this.canAcceptChildren(n)}}return null}canAcceptChildren(e){return["div","section","article","header","footer","nav","main","aside"].includes(e.tagName.toLowerCase())}calculateInsertPosition(e,t){if("canvas"===e.id){const n=Array.from(e.children).filter(e=>e.classList.contains("canvas-element"));if(0===n.length)return{type:"append",reference:null};let o=null,i=1/0,r=!1;return n.forEach(e=>{const n=e.getBoundingClientRect(),a=n.top+n.height/2,s=Math.abs(a-t.clientY);s<i&&(i=s,o=e,r=t.clientY<a)}),{type:r?"before":"after",reference:o}}const n=e.getBoundingClientRect(),o=t.clientY-n.top,i=n.height/3;return o<i?{type:"before",reference:e}:o>n.height-i?{type:"after",reference:e}:this.canAcceptChildren(e)?{type:"append",reference:e}:{type:"after",reference:e}}moveElement(e,t,n){if("before"===n.type)n.reference.parentNode.insertBefore(e,n.reference);else if("after"===n.type){const t=n.reference.nextSibling;t?n.reference.parentNode.insertBefore(e,t):n.reference.parentNode.appendChild(e)}else"append"===n.type&&(n.reference||t).appendChild(e);window.selectElement&&window.selectElement(e),window.showToast&&window.showToast("‚úÖ Elemento reordenado")}createNewComponent(e,t,n){if(!window.createComponent)return void console.error("createComponent no est√° disponible");const o=window.createComponent(e);if("before"===n.type)n.reference.parentNode.insertBefore(o,n.reference);else if("after"===n.type){const e=n.reference.nextSibling;e?n.reference.parentNode.insertBefore(o,e):n.reference.parentNode.appendChild(o)}else"append"===n.type&&(n.reference||t).appendChild(o);window.selectElement&&window.selectElement(o),window.showToast&&window.showToast("‚úÖ Componente agregado")}createDropIndicator(){this.dropIndicator=document.createElement("div"),this.dropIndicator.className="enhanced-drop-indicator",this.dropIndicator.innerHTML='<div class="indicator-line"></div>',document.body.appendChild(this.dropIndicator)}showDropIndicator(e,t){if(!this.dropIndicator)return;const n=this.calculateInsertPosition(e.element,t);let o;"append"===n.type&&n.reference?(o=n.reference.getBoundingClientRect(),this.dropIndicator.style.left=o.left+"px",this.dropIndicator.style.top=o.top+o.height/2+"px",this.dropIndicator.style.width=o.width+"px",this.dropIndicator.classList.add("mode-append"),this.dropIndicator.classList.remove("mode-insert")):n.reference&&(o=n.reference.getBoundingClientRect(),this.dropIndicator.style.left=o.left+"px",this.dropIndicator.style.width=o.width+"px","before"===n.type?this.dropIndicator.style.top=o.top-2+"px":this.dropIndicator.style.top=o.bottom-2+"px",this.dropIndicator.classList.add("mode-insert"),this.dropIndicator.classList.remove("mode-append")),this.dropIndicator.style.display="block"}hideDropIndicator(){this.dropIndicator&&(this.dropIndicator.style.display="none")}highlightDropZones(){const e=document.getElementById("canvas");null==e||e.classList.add("drop-zone-active"),document.querySelectorAll(".canvas-element").forEach(e=>{e!==this.draggedElement&&this.canAcceptChildren(e)&&e.classList.add("potential-drop-zone")})}clearDropZones(){var e;null==(e=document.getElementById("canvas"))||e.classList.remove("drop-zone-active"),document.querySelectorAll(".potential-drop-zone").forEach(e=>{e.classList.remove("potential-drop-zone")})}handleAutoScroll(e){const t=document.querySelector(".canvas-panel");if(!t)return;const n=t.getBoundingClientRect(),o=t.scrollTop;e.clientY-n.top<this.scrollEdgeSize?t.scrollTop=o-this.scrollSpeed:n.bottom-e.clientY<this.scrollEdgeSize&&(t.scrollTop=o+this.scrollSpeed)}cleanup(){this.isDragging=!1,this.draggedElement=null,this.draggedType=null,this.hideDropIndicator(),this.clearDropZones(),this.dragPreview&&(this.dragPreview.remove(),this.dragPreview=null),document.querySelectorAll(".dragging, .dragging-canvas-element").forEach(e=>{e.classList.remove("dragging","dragging-canvas-element")})}dispatchEvent(e,t){const n=new CustomEvent(`dragdrop:${e}`,{detail:t,bubbles:!0});window.dispatchEvent(n)}injectStyles(){const e="enhanced-dragdrop-styles";if(document.getElementById(e))return;const t=document.createElement("style");t.id=e,t.textContent="\n            /* Drag handle */\n            .drag-handle {\n                position: absolute;\n                top: 50%;\n                left: -20px;\n                transform: translateY(-50%);\n                width: 16px;\n                height: 30px;\n                background: #2563eb;\n                color: white;\n                display: none;\n                align-items: center;\n                justify-content: center;\n                border-radius: 4px 0 0 4px;\n                cursor: grab;\n                font-size: 10px;\n                letter-spacing: -1px;\n                z-index: 998;\n                opacity: 0;\n                transition: all 0.2s;\n            }\n\n            .canvas-element.selected .drag-handle {\n                display: flex;\n            }\n\n            .canvas-element.selected:hover .drag-handle {\n                opacity: 1;\n                left: -22px;\n            }\n\n            .drag-handle:active {\n                cursor: grabbing;\n            }\n\n            /* Preview de drag */\n            .drag-preview {\n                position: fixed;\n                top: -9999px;\n                left: -9999px;\n                background: white;\n                border: 2px solid #2563eb;\n                border-radius: 6px;\n                padding: 8px 16px;\n                box-shadow: 0 10px 25px rgba(0,0,0,0.2);\n                font-size: 13px;\n                font-weight: 500;\n                color: #1e293b;\n                z-index: 10000;\n                opacity: 0.9;\n                pointer-events: none;\n            }\n\n            /* Indicador de drop mejorado */\n            .enhanced-drop-indicator {\n                position: fixed;\n                height: 4px;\n                z-index: 9999;\n                display: none;\n                pointer-events: none;\n            }\n\n            .enhanced-drop-indicator .indicator-line {\n                width: 100%;\n                height: 100%;\n                background: linear-gradient(90deg, #3b82f6, #1d4ed8);\n                border-radius: 2px;\n                box-shadow: 0 0 10px rgba(59, 130, 246, 0.6);\n                animation: indicatorPulse 1s infinite;\n            }\n\n            .enhanced-drop-indicator.mode-append .indicator-line {\n                background: linear-gradient(90deg, #10b981, #059669);\n                box-shadow: 0 0 10px rgba(16, 185, 129, 0.6);\n            }\n\n            @keyframes indicatorPulse {\n                0%, 100% { opacity: 1; transform: scaleX(1); }\n                50% { opacity: 0.7; transform: scaleX(0.95); }\n            }\n\n            /* Zonas de drop */\n            .drop-zone-active {\n                background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%) !important;\n                outline: 2px dashed #3b82f6 !important;\n                outline-offset: 4px;\n            }\n\n            .potential-drop-zone {\n                outline: 2px dashed #10b981 !important;\n                outline-offset: 2px;\n                background: rgba(16, 185, 129, 0.05) !important;\n            }\n\n            /* Estados de arrastre */\n            .component-item.dragging {\n                opacity: 0.5;\n                transform: scale(0.95);\n                background: #e0f2fe !important;\n            }\n\n            .canvas-element.dragging-canvas-element {\n                opacity: 0.4;\n                outline: 2px dashed #3b82f6 !important;\n            }\n\n            /* Cursor durante drag */\n            body.dragging-active {\n                cursor: grabbing !important;\n            }\n\n            body.dragging-active * {\n                cursor: inherit !important;\n            }\n        ",document.head.appendChild(t)}destroy(){this.cleanup(),this.dropIndicator&&this.dropIndicator.remove(),console.log("üóëÔ∏è EnhancedDragDropManager destruido")}};const q=document.createElement("style");q.textContent="\n    .project-analysis-modal {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100vh;\n        z-index: 3000;\n        display: none;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .project-analysis-modal .modal-overlay {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.6);\n    }\n\n    .project-analysis-modal .modal-content {\n        background: white;\n        border-radius: 12px;\n        width: 90%;\n        max-width: 800px;\n        max-height: 85vh;\n        position: relative;\n        z-index: 10;\n        box-shadow: 0 20px 25px -5px rgba(0,0,0,0.3);\n        display: flex;\n        flex-direction: column;\n    }\n\n    .project-analysis-modal .modal-content.analysis-results {\n        max-width: 900px;\n    }\n\n    .project-analysis-modal .modal-header {\n        padding: 20px 24px;\n        border-bottom: 1px solid #e2e8f0;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n\n    .project-analysis-modal .modal-header h3 {\n        margin: 0;\n        font-size: 18px;\n        color: #1e293b;\n    }\n\n    .project-analysis-modal .modal-close-btn {\n        background: none;\n        border: none;\n        font-size: 24px;\n        cursor: pointer;\n        color: #64748b;\n    }\n\n    .project-analysis-modal .modal-body {\n        padding: 24px;\n        overflow-y: auto;\n        flex: 1;\n    }\n\n    .project-analysis-modal .modal-footer {\n        padding: 16px 24px;\n        border-top: 1px solid #e2e8f0;\n        display: flex;\n        gap: 12px;\n        justify-content: flex-end;\n    }\n\n    .project-analysis-modal .loading-spinner {\n        width: 50px;\n        height: 50px;\n        border: 4px solid #e2e8f0;\n        border-top-color: #2563eb;\n        border-radius: 50%;\n        animation: spin 1s linear infinite;\n        margin: 0 auto 20px;\n    }\n\n    @keyframes spin {\n        to { transform: rotate(360deg); }\n    }\n\n    .project-info h4 {\n        margin: 0 0 16px 0;\n        color: #1e293b;\n    }\n\n    .info-grid {\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n        gap: 12px;\n        margin-bottom: 24px;\n    }\n\n    .info-item {\n        background: #f8fafc;\n        padding: 12px;\n        border-radius: 6px;\n        display: flex;\n        flex-direction: column;\n        gap: 4px;\n    }\n\n    .info-label {\n        font-size: 12px;\n        color: #64748b;\n        font-weight: 500;\n    }\n\n    .info-value {\n        font-size: 16px;\n        color: #1e293b;\n        font-weight: 600;\n    }\n\n    .file-tree-container {\n        margin: 24px 0;\n    }\n\n    .file-tree-container h4 {\n        margin: 0 0 12px 0;\n        color: #1e293b;\n    }\n\n    .file-tree {\n        background: #f8fafc;\n        border: 1px solid #e2e8f0;\n        border-radius: 6px;\n        padding: 12px;\n        max-height: 300px;\n        overflow-y: auto;\n        font-family: 'Monaco', 'Courier New', monospace;\n        font-size: 13px;\n    }\n\n    .tree-item {\n        padding: 4px 8px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        border-radius: 4px;\n        transition: background 0.2s;\n    }\n\n    .tree-item:hover {\n        background: #e2e8f0;\n    }\n\n    .tree-item.directory {\n        font-weight: 600;\n        color: #475569;\n    }\n\n    .tree-item.file {\n        color: #64748b;\n    }\n\n    .tree-icon {\n        font-size: 14px;\n        flex-shrink: 0;\n    }\n\n    .tree-name {\n        flex: 1;\n    }\n\n    .tree-size {\n        font-size: 11px;\n        color: #94a3b8;\n    }\n\n    .main-files {\n        margin-top: 24px;\n    }\n\n    .main-files h4 {\n        margin: 0 0 12px 0;\n        color: #1e293b;\n    }\n\n    .files-list {\n        list-style: none;\n        padding: 0;\n        margin: 0;\n    }\n\n    .files-list li {\n        padding: 10px 12px;\n        background: #f8fafc;\n        border: 1px solid #e2e8f0;\n        border-radius: 6px;\n        margin-bottom: 8px;\n        display: flex;\n        align-items: center;\n        gap: 12px;\n    }\n\n    .file-icon {\n        font-size: 18px;\n    }\n\n    .file-name {\n        font-weight: 600;\n        color: #1e293b;\n    }\n\n    .file-path {\n        font-size: 12px;\n        color: #64748b;\n        margin-left: auto;\n    }\n",document.head.appendChild(q),window.ProjectAnalyzer=class{constructor(){this.geminiValidator=null,this.currentProject=null,this.fileTree=null,this.analysisCache=new Map,this.supportedExtensions=[".html",".htm",".js",".jsx",".css",".scss",".sass",".json"],this.maxFileSize=512e3,this.init()}init(){window.GeminiSyntaxValidator&&(this.geminiValidator=new window.GeminiSyntaxValidator),console.log("‚úÖ ProjectAnalyzer inicializado")}loadDirectory(e){return u(this,null,function*(){try{if(!e||0===e.length)throw new Error("No se seleccionaron archivos");this.showLoadingModal("Analizando proyecto..."),this.fileTree=yield this.buildFileTree(e);const t=yield this.analyzeProjectStructure(this.fileTree),n=this.identifyMainFiles(this.fileTree);return this.currentProject={name:this.extractProjectName(this.fileTree),tree:this.fileTree,structure:t,mainFiles:n,totalFiles:e.length,timestamp:Date.now()},this.hideLoadingModal(),this.showAnalysisResults(this.currentProject),this.currentProject}catch(t){throw this.hideLoadingModal(),console.error("Error analizando proyecto:",t),window.showToast&&window.showToast(`‚ùå Error: ${t.message}`,"error"),t}})}buildFileTree(e){return u(this,null,function*(){const t={name:"root",type:"directory",children:new Map,files:[]};for(const n of e){const e=this.getFileExtension(n.name);if(!this.supportedExtensions.includes(e))continue;if(n.size>this.maxFileSize){console.warn(`Archivo muy grande, ignorando: ${n.name}`);continue}const o=yield this.readFileContent(n),i=n.webkitRelativePath?n.webkitRelativePath.split("/"):[n.name];this.insertIntoTree(t,i,{name:n.name,path:n.webkitRelativePath||n.name,type:"file",extension:e,size:n.size,content:o,lastModified:n.lastModified})}return t})}insertIntoTree(e,t,n){if(1===t.length)return void e.files.push(n);const o=t[0];e.children.has(o)||e.children.set(o,{name:o,type:"directory",children:new Map,files:[]}),this.insertIntoTree(e.children.get(o),t.slice(1),n)}readFileContent(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>t(e.target.result),o.onerror=e=>n(new Error("Error leyendo archivo")),o.readAsText(e)})}analyzeProjectStructure(e){return u(this,null,function*(){const t={hasPackageJson:!1,hasIndexHtml:!1,framework:"vanilla",buildTool:null,dependencies:[],scripts:{},directories:{src:!1,public:!1,dist:!1,components:!1,assets:!1}},n=this.flattenTree(e);for(const e of n){const n=e.name.toLowerCase();if("package.json"===n){t.hasPackageJson=!0;try{const n=JSON.parse(e.content);t.dependencies=Object.keys(n.dependencies||{}),t.scripts=n.scripts||{},t.framework=this.detectFramework(n),t.buildTool=this.detectBuildTool(n)}catch(o){console.warn("Error parseando package.json")}}"index.html"!==n&&"index.htm"!==n||(t.hasIndexHtml=!0)}return this.detectCommonDirectories(e,t.directories),t})}detectFramework(e){const t=d(d({},e.dependencies),e.devDependencies);return t.react?"react":t.vue?"vue":t["@angular/core"]?"angular":t.svelte?"svelte":t.next?"next":t.nuxt?"nuxt":"vanilla"}detectBuildTool(e){const t=d(d({},e.dependencies),e.devDependencies);return t.vite?"vite":t.webpack?"webpack":t.rollup?"rollup":t.parcel?"parcel":t.esbuild?"esbuild":null}detectCommonDirectories(e,t){const n=e.name.toLowerCase();"src"===n&&(t.src=!0),"public"===n&&(t.public=!0),"dist"!==n&&"build"!==n||(t.dist=!0),"components"===n&&(t.components=!0),"assets"!==n&&"static"!==n||(t.assets=!0);for(const o of e.children.values())this.detectCommonDirectories(o,t)}identifyMainFiles(e){const t=this.flattenTree(e),n={html:[],entry:[],config:[]};for(const o of t){const e=o.name.toLowerCase(),t=o.extension;".html"!==t&&".htm"!==t||"index.html"!==e&&"index.htm"!==e&&!e.includes("main")||n.html.push(o),".js"!==t&&".jsx"!==t||"index.js"!==e&&"main.js"!==e&&"app.js"!==e&&!e.includes("entry")||n.entry.push(o),"package.json"!==e&&"vite.config.js"!==e&&"webpack.config.js"!==e&&"tsconfig.json"!==e||n.config.push(o)}return n}flattenTree(e,t=[]){if(e.files&&t.push(...e.files),e.children)for(const n of e.children.values())this.flattenTree(n,t);return t}extractProjectName(e){const t=this.flattenTree(e).find(e=>"package.json"===e.name);if(t)try{const e=JSON.parse(t.content);if(e.name)return e.name}catch(n){}return e.children.size>0?Array.from(e.children.keys())[0]:"Proyecto sin nombre"}importHTMLFiles(e){return u(this,null,function*(){if(!e||0===e.length)throw new Error("No hay archivos HTML para importar");const t=e[0];if(window.htmlParser){const e=window.htmlParser.parse(t.content);this.loadParsedHTMLToCanvas(e),window.showToast&&window.showToast(`‚úÖ ${t.name} importado correctamente`)}else{const e=document.getElementById("canvas");if(e){const n=t.content.match(/<body[^>]*>([\s\S]*)<\/body>/i),o=n?n[1]:t.content;e.innerHTML=o,window.setupElementsEvents&&window.setupElementsEvents()}}})}loadParsedHTMLToCanvas(e){const t=document.getElementById("canvas");t&&(t.innerHTML=e.html,window.setupElementsEvents&&window.setupElementsEvents())}getFileExtension(e){const t=e.split(".");return t.length>1?"."+t[t.length-1].toLowerCase():""}showLoadingModal(e){let t=document.getElementById("project-loading-modal");t||(t=document.createElement("div"),t.id="project-loading-modal",t.className="project-analysis-modal",document.body.appendChild(t)),t.innerHTML=`\n            <div class="modal-overlay"></div>\n            <div class="modal-content">\n                <div class="loading-spinner"></div>\n                <h3>${e}</h3>\n                <p>Esto puede tomar unos segundos...</p>\n            </div>\n        `,t.style.display="flex"}hideLoadingModal(){const e=document.getElementById("project-loading-modal");e&&(e.style.display="none")}showAnalysisResults(e){const t=document.createElement("div");t.className="project-analysis-modal";const n=this.renderFileTree(e.tree);t.innerHTML=`\n            <div class="modal-overlay"></div>\n            <div class="modal-content analysis-results">\n                <div class="modal-header">\n                    <h3>üìä An√°lisis del Proyecto</h3>\n                    <button class="modal-close-btn">&times;</button>\n                </div>\n                <div class="modal-body">\n                    <div class="project-info">\n                        <h4>${e.name}</h4>\n                        <div class="info-grid">\n                            <div class="info-item">\n                                <span class="info-label">Archivos:</span>\n                                <span class="info-value">${e.totalFiles}</span>\n                            </div>\n                            <div class="info-item">\n                                <span class="info-label">Framework:</span>\n                                <span class="info-value">${e.structure.framework}</span>\n                            </div>\n                            ${e.structure.buildTool?`\n                            <div class="info-item">\n                                <span class="info-label">Build Tool:</span>\n                                <span class="info-value">${e.structure.buildTool}</span>\n                            </div>\n                            `:""}\n                        </div>\n                    </div>\n\n                    <div class="file-tree-container">\n                        <h4>üìÅ Estructura de Archivos</h4>\n                        <div class="file-tree">\n                            ${n}\n                        </div>\n                    </div>\n\n                    ${e.mainFiles.html.length>0?`\n                    <div class="main-files">\n                        <h4>üìÑ Archivos HTML Encontrados</h4>\n                        <ul class="files-list">\n                            ${e.mainFiles.html.map(e=>`\n                                <li>\n                                    <span class="file-icon">üìÑ</span>\n                                    <span class="file-name">${e.name}</span>\n                                    <span class="file-path">${e.path}</span>\n                                </li>\n                            `).join("")}\n                        </ul>\n                    </div>\n                    `:""}\n                </div>\n                <div class="modal-footer">\n                    <button class="btn btn-secondary" data-action="cancel">Cancelar</button>\n                    ${e.mainFiles.html.length>0?'\n                    <button class="btn btn-primary" data-action="import">\n                        Importar HTML Principal\n                    </button>\n                    ':""}\n                </div>\n            </div>\n        `,t.querySelector(".modal-close-btn").addEventListener("click",()=>t.remove()),t.querySelector(".modal-overlay").addEventListener("click",()=>t.remove()),t.querySelector('[data-action="cancel"]').addEventListener("click",()=>t.remove());const o=t.querySelector('[data-action="import"]');o&&o.addEventListener("click",()=>u(this,null,function*(){try{yield this.importHTMLFiles(e.mainFiles.html),t.remove()}catch(n){alert(`Error importando: ${n.message}`)}})),document.body.appendChild(t)}renderFileTree(e,t=0){let n="";if(e.files&&e.files.length>0)for(const o of e.files)n+=`\n                    <div class="tree-item file" style="padding-left: ${20*t}px;">\n                        <span class="tree-icon">${this.getFileIcon(o.extension)}</span>\n                        <span class="tree-name">${o.name}</span>\n                        <span class="tree-size">${this.formatFileSize(o.size)}</span>\n                    </div>\n                `;if(e.children&&e.children.size>0)for(const[o,i]of e.children.entries())n+=`\n                    <div class="tree-item directory" style="padding-left: ${20*t}px;">\n                        <span class="tree-icon">üìÅ</span>\n                        <span class="tree-name">${o}/</span>\n                    </div>\n                `,n+=this.renderFileTree(i,t+1);return n}getFileIcon(e){return{".html":"üìÑ",".htm":"üìÑ",".js":"üìú",".jsx":"‚öõÔ∏è",".css":"üé®",".scss":"üé®",".sass":"üé®",".json":"üìã",".md":"üìù"}[e]||"üìÑ"}formatFileSize(e){return e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB"}}}},function(){return t||(0,e[r(e)[0]])((t={exports:{}}).exports,t),t.exports});export default h();
//# sourceMappingURL=main-aBfwshUM.js.map
